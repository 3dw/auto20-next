"use strict";(self["webpackChunkauto20_next"]=self["webpackChunkauto20_next"]||[]).push([[138],{1063:function(e,t,o){o.r(t),o.d(t,{default:function(){return Rt}});var l=o(6768),i=o(4232),r=o(5130);const a=e=>((0,l.Qi)("data-v-5f15a1ab"),e=e(),(0,l.jt)(),e),s={class:"hello"},n={key:0},d={key:1,class:"ui divider"},u={key:2},h={key:3},p={key:4},c={class:"ui grid container"},f={key:0,class:"ui stackable two column row"},m={class:"ten wide column"},g={class:"ui fluid card container"},k={key:0,class:"filler"},v={class:"six wide column"},_=a((()=>(0,l.Lk)("i",{class:"edit icon"},null,-1))),b={key:0},L={key:1},$={key:1,class:"filler"},w={key:5,class:"ui container"},C={key:0,class:"ui warning message"},y={class:"header"},U={key:0},I={class:"ui form error warning success",id:"main-form"},N={class:"ui header"},E={class:"sub header"},X=a((()=>(0,l.Lk)("br",null,null,-1))),Q=a((()=>(0,l.Lk)("i",{class:"red star"},null,-1))),R={class:"ui vertical buttons"},V=a((()=>(0,l.Lk)("i",{class:"file icon"},null,-1))),W=a((()=>(0,l.Lk)("i",{class:"file icon"},null,-1))),x=a((()=>(0,l.Lk)("i",{class:"download icon"},null,-1))),F=a((()=>(0,l.Lk)("div",{class:"ui divider"},null,-1))),D={class:"ui dividing header"},J={class:"field"},A={class:"required"},G=["placeholder"],M={class:"required"},T=["placeholder"],j={key:0,class:"ui error message"},K={class:"header"},S=a((()=>(0,l.Lk)("br",null,null,-1))),B={href:"https://www.google.com.tw/chrome/browser/desktop/",target:"_blank"},q={key:1,class:"ui warning message"},O={class:"header"},Z={class:"ui header"},P={class:"sub header"},z=a((()=>(0,l.Lk)("div",{id:"map",style:{height:"300px"}},null,-1))),H=a((()=>(0,l.Lk)("div",{class:"ui divider"},null,-1))),Y={class:"field"},ee={class:"two fields"},te={class:"field"},oe=["placeholder"],le={key:0},ie=["href"],re=["src","title","alt"],ae={class:"field"},se=["placeholder"],ne={key:0},de=["href"],ue=["src","title","alt"],he={class:"two fields"},pe={class:"field"},ce={class:"required"},fe=["placeholder"],me={class:"field"},ge=["placeholder"],ke={class:"ui dividing header"},ve={class:"field"},_e={value:""},be=["value"],Le={class:"field"},$e={value:""},we=["value"],Ce={class:"required"},ye=["placeholder"],Ue={key:0},Ie={key:1,class:"ui warning message"},Ne={class:"header"},Ee={key:2,class:"ui error message"},Xe={class:"header"},Qe={class:"field"},Re=["placeholder"],Ve=a((()=>(0,l.Lk)("br",null,null,-1))),We={key:0},xe=a((()=>(0,l.Lk)("div",{class:"ui divider"},null,-1))),Fe={style:{"margin-left":"15px"}},De=a((()=>(0,l.Lk)("br",null,null,-1))),Je=["placeholder"],Ae=a((()=>(0,l.Lk)("br",null,null,-1))),Ge={key:1},Me=a((()=>(0,l.Lk)("div",{class:"ui divider"},null,-1))),Te={class:"three fields"},je={class:"field"},Ke={class:"required"},Se=["placeholder"],Be={class:"field"},qe={class:"required"},Oe=["placeholder"],Ze={class:"field"},Pe=["placeholder"],ze={class:"field"},He=["placeholder"],Ye={class:"field"},et={class:"required"},tt=["placeholder"],ot={key:0,class:"ui warning message"},lt={class:"header"},it={key:1,class:"ui success message"},rt={class:"header"},at={key:3,class:"warning"},st={key:4,class:"warning"},nt=a((()=>(0,l.Lk)("i",{class:"red star"},null,-1))),dt={key:1},ut={class:"ui vertical buttons"},ht={key:0},pt=a((()=>(0,l.Lk)("i",{class:"flag icon"},null,-1))),ct={key:1},ft=a((()=>(0,l.Lk)("i",{class:"flag icon"},null,-1))),mt=a((()=>(0,l.Lk)("i",{class:"user icon"},null,-1))),gt=a((()=>(0,l.Lk)("i",{class:"chevron right icon"},null,-1))),kt=a((()=>(0,l.Lk)("i",{class:"delete icon"},null,-1))),vt=a((()=>(0,l.Lk)("br",null,null,-1))),_t=a((()=>(0,l.Lk)("br",null,null,-1))),bt=a((()=>(0,l.Lk)("br",null,null,-1))),Lt=a((()=>(0,l.Lk)("br",null,null,-1)));function $t(e,t,o,a,$t,wt){const Ct=(0,l.g2)("router-link"),yt=(0,l.g2)("card");return(0,l.uX)(),(0,l.CE)("div",s,[o.isInApp?((0,l.uX)(),(0,l.CE)("p",n,(0,i.v_)(e.$t("login.isapp")),1)):(0,l.Q3)("",!0),(0,l.bo)((0,l.Lk)("p",null,[(0,l.eW)((0,i.v_)(e.$t("profile.announce1")),1),(0,l.bF)(Ct,{target:"_blank",to:"/privacy-policy"},{default:(0,l.k6)((()=>[(0,l.eW)((0,i.v_)(e.$t("profile.announce2")),1)])),_:1}),(0,l.eW)((0,i.v_)(e.$t("profile.announce3")),1)],512),[[r.aG,$t.isNew]]),$t.isNew?((0,l.uX)(),(0,l.CE)("div",d)):(0,l.Q3)("",!0),$t.isNew?((0,l.uX)(),(0,l.CE)("br",u)):(0,l.Q3)("",!0),$t.isNew?((0,l.uX)(),(0,l.CE)("br",h)):(0,l.Q3)("",!0),$t.isNew?((0,l.uX)(),(0,l.CE)("br",p)):(0,l.Q3)("",!0),(0,l.Lk)("div",c,[$t.editing?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",f,[(0,l.bo)((0,l.Lk)("div",m,[(0,l.bo)((0,l.Lk)("div",g,[(0,l.bF)(yt,{h:$t.root,full:!0,book:e.book,onLocate:wt.locate,onAddBook:wt.addBook,onLoginGoogle:wt.loginGoogle,uid:o.uid},null,8,["h","book","onLocate","onAddBook","onLoginGoogle","uid"])],512),[[r.aG,!$t.isNew&&!$t.editing]])],512),[[r.aG,!$t.isNew]]),$t.isNew?((0,l.uX)(),(0,l.CE)("div",k)):(0,l.Q3)("",!0),(0,l.Lk)("div",v,[(0,l.bo)((0,l.Lk)("div",{class:"ui massive green button",onClick:t[0]||(t[0]=(...e)=>wt.startEdit&&wt.startEdit(...e))},[_,(0,l.eW)((0,i.v_)(e.$t("profile.push")),1),$t.isNew?((0,l.uX)(),(0,l.CE)("span",b,(0,i.v_)(e.$t("profile.start")),1)):((0,l.uX)(),(0,l.CE)("span",L,(0,i.v_)(e.$t("profile.edit")),1))],512),[[r.aG,o.uid&&!$t.editing]])]),$t.isNew?((0,l.uX)(),(0,l.CE)("div",$)):(0,l.Q3)("",!0)]))]),$t.editing?((0,l.uX)(),(0,l.CE)("div",w,[wt.longTimeNoSee()>.25&&!$t.isNew?((0,l.uX)(),(0,l.CE)("div",C,[(0,l.Lk)("div",y,(0,i.v_)(e.$t("profile.update1")),1),wt.longTimeNoSee()>.25?((0,l.uX)(),(0,l.CE)("span",U,(0,i.v_)(e.$t("profile.update2")),1)):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0),(0,l.bo)((0,l.Lk)("form",I,[(0,l.Lk)("h2",N,(0,i.v_)(e.$t("profile.fillform")),1),(0,l.Lk)("div",E,[(0,l.eW)((0,i.v_)(e.$t("profile.form1")),1),X,(0,l.eW)((0,i.v_)(e.$t("profile.form2")),1),Q,(0,l.eW)((0,i.v_)(e.$t("profile.form3")),1)]),(0,l.Lk)("div",R,[(0,l.bo)((0,l.Lk)("button",{class:"ui basic purple button",onClick:t[1]||(t[1]=(0,r.D$)((t=>e.$refs.fileInput.click()),["prevent"]))},[V,(0,l.eW)("匯入自學2.0格式資料")],512),[[r.aG,!$t.fileUploaded]]),(0,l.Lk)("input",{type:"file",ref:"fileInput",onChange:t[2]||(t[2]=(...e)=>wt.handleFileChange&&wt.handleFileChange(...e)),style:{display:"none"}},null,544),(0,l.bo)((0,l.Lk)("button",{class:(0,i.C4)(["ui purple button",{disabled:!$t.fileUploaded}]),onClick:t[3]||(t[3]=(0,r.D$)((e=>wt.importData()),["prevent"]))},[W,(0,l.eW)("確認匯入")],2),[[r.aG,$t.fileUploaded]]),(0,l.bo)((0,l.Lk)("button",{class:"ui basic green button",onClick:t[4]||(t[4]=(0,r.D$)((e=>wt.exportData()),["prevent"]))},[x,(0,l.eW)("匯出自學2.0格式資料")],512),[[r.aG,!$t.isNew]])]),F,(0,l.Lk)("h4",D,(0,i.v_)(e.$t("profile.form4")),1),(0,l.Lk)("div",J,[(0,l.Lk)("label",A,(0,i.v_)(e.$t("profile.form5")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[5]||(t[5]=e=>$t.root.name=e),onInput:t[6]||(t[6]=e=>wt.filterInput("name",e)),placeholder:e.$t("profile.form6")},null,40,G),[[r.Jo,$t.root.name]])]),(0,l.Lk)("div",{class:(0,i.C4)(["field",{error:$t.root.address&&("undefined,undefined"==$t.root.latlngColumn||"36.778261,-119.4179324"==$t.root.latlngColumn)}])},[(0,l.Lk)("label",M,(0,i.v_)(e.$t("profile.form7")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>$t.root.address=e),onInput:t[8]||(t[8]=e=>wt.filterInput("address",e)),placeholder:e.$t("profile.form8")},null,40,T),[[r.Jo,$t.root.address,void 0,{trim:!0}]]),!$t.root.address||"undefined,undefined"!=$t.root.latlngColumn&&"36.778261,-119.4179324"!=$t.root.latlngColumn?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",j,[(0,l.Lk)("div",K,(0,i.v_)(e.$t("profile.form9")),1),(0,l.Lk)("p",null,[(0,l.eW)((0,i.v_)(e.$t("profile.form10")),1),S,(0,l.eW)((0,i.v_)(e.$t("profile.form11")),1),(0,l.Lk)("a",B,(0,i.v_)(e.$t("profile.form12")),1),(0,l.eW)((0,i.v_)(e.$t("profile.form13")),1)])])),wt.tooDetail($t.root.address)?((0,l.uX)(),(0,l.CE)("div",q,[(0,l.Lk)("div",O,(0,i.v_)(e.$t("profile.form14")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form15")),1)])):(0,l.Q3)("",!0)],2),(0,l.Lk)("h4",Z,[(0,l.eW)((0,i.v_)(e.$t("profile.form16")),1),(0,l.Lk)("div",P,(0,i.v_)(e.$t("profile.form17"))+"："+(0,i.v_)($t.root.latlngColumn),1)]),z,H,(0,l.Lk)("div",Y,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form18")),1),(0,l.Lk)("div",ee,[(0,l.Lk)("div",te,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[9]||(t[9]=e=>$t.root.site=e),onInput:t[10]||(t[10]=e=>wt.filterInput("site",e)),placeholder:e.$t("profile.form19")},null,40,oe),[[r.Jo,$t.root.site]]),$t.root.site?((0,l.uX)(),(0,l.CE)("span",le,[(0,l.Lk)("a",{href:$t.root.site,target:"_blank"},[(0,l.Lk)("img",{src:"https://www.google.com/s2/favicons?domain="+$t.root.site,title:e.$t("profile.form19"),alt:e.$t("profile.form19")},null,8,re),(0,l.eW)((0,i.v_)(e.$t("profile.form20")),1)],8,ie)])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",ae,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>$t.root.site2=e),onInput:t[12]||(t[12]=e=>wt.filterInput("site2",e)),placeholder:e.$t("profile.form21")},null,40,se),[[r.Jo,$t.root.site2]]),$t.root.site2?((0,l.uX)(),(0,l.CE)("span",ne,[(0,l.Lk)("a",{href:$t.root.site2,target:"_blank"},[(0,l.Lk)("img",{src:"https://www.google.com/s2/favicons?domain="+$t.root.site2,title:e.$t("profile.form22"),alt:e.$t("profile.form22")},null,8,ue),(0,l.eW)((0,i.v_)(e.$t("profile.form20")),1)],8,de)])):(0,l.Q3)("",!0)])])]),(0,l.Lk)("div",he,[(0,l.Lk)("div",pe,[(0,l.Lk)("label",ce,(0,i.v_)(e.$t("profile.form23")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[13]||(t[13]=e=>$t.root.connect_me=e),onInput:t[14]||(t[14]=e=>wt.filterInput("connect_me",e)),placeholder:e.$t("profile.form24")},null,40,fe),[[r.Jo,$t.root.connect_me]])]),(0,l.Lk)("div",me,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form25")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[15]||(t[15]=e=>$t.root.freetime=e),onInput:t[16]||(t[16]=e=>wt.filterInput("freetime",e)),placeholder:e.$t("profile.form26")},null,40,ge),[[r.Jo,$t.root.freetime]])])]),(0,l.Lk)("h4",ke,(0,i.v_)(e.$t("profile.form27")),1),(0,l.Lk)("div",ve,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form28")),1),(0,l.bo)((0,l.Lk)("select",{class:"selectpicker","onUpdate:modelValue":t[17]||(t[17]=e=>$t.root.learner_role=e)},[(0,l.Lk)("option",_e,"-- "+(0,i.v_)(e.$t("profile.form29"))+" --",1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)([e.$t("profile.form30"),e.$t("profile.form31"),e.$t("profile.form32"),e.$t("profile.form33"),e.$t("profile.form34"),e.$t("profile.form35"),e.$t("profile.form36")],(e=>((0,l.uX)(),(0,l.CE)("option",{value:e},(0,i.v_)(e),9,be)))),256))],512),[[r.u1,$t.root.learner_role]])]),(0,l.Lk)("div",Le,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form37")),1),(0,l.bo)((0,l.Lk)("select",{class:"selectpicker","onUpdate:modelValue":t[18]||(t[18]=e=>$t.root.learner_type=e)},[(0,l.Lk)("option",$e,"-- "+(0,i.v_)(e.$t("profile.form38"))+" --",1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)([e.$t("profile.form39"),e.$t("profile.form40"),e.$t("profile.form41"),e.$t("profile.form42")],(e=>((0,l.uX)(),(0,l.CE)("option",{value:e},(0,i.v_)(e),9,we)))),256))],512),[[r.u1,$t.root.learner_type]])]),(0,l.Lk)("div",{class:(0,i.C4)(["field",{error:e.badAge($t.root.learner_birth),warning:!$t.root.learner_birth}])},[(0,l.Lk)("label",Ce,(0,i.v_)(e.$t("profile.form43")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":t[19]||(t[19]=e=>$t.root.learner_birth=e),onInput:t[20]||(t[20]=e=>wt.filterInput("learner_birth",e)),placeholder:e.$t("profile.form44")},null,40,ye),[[r.Jo,$t.root.learner_birth]])],2),$t.root.learner_birth?((0,l.uX)(),(0,l.CE)("span",Ue,(0,i.v_)(e.$t("profile.form45"))+(0,i.v_)(e.toAge($t.root.learner_birth))+(0,i.v_)(e.$t("login.old")),1)):(0,l.Q3)("",!0),$t.root.learner_birth?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",Ie,[(0,l.Lk)("div",Ne,(0,i.v_)(e.$t("profile.form46")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form47")),1)])),e.badAge($t.root.learner_birth)?((0,l.uX)(),(0,l.CE)("div",Ee,[(0,l.Lk)("div",Xe,(0,i.v_)(e.$t("profile.form48")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form49")),1)])):(0,l.Q3)("",!0),(0,l.Lk)("div",Qe,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form50")),1),(0,l.Lk)("span",null,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[21]||(t[21]=e=>$t.root.child_birth=e),onInput:t[22]||(t[22]=e=>wt.filterInput("child_birth",e)),type:"text",placeholder:e.$t("profile.form51")},null,40,Re),[[r.Jo,$t.root.child_birth]]),Ve,$t.root.child_birth?((0,l.uX)(),(0,l.CE)("span",We,(0,i.v_)(e.$t("profile.form45"))+(0,i.v_)(e.toAge($t.root.child_birth))+(0,i.v_)(e.$t("login.old")),1)):(0,l.Q3)("",!0),xe,(0,l.Lk)("span",Fe,[(0,l.eW)((0,i.v_)(e.$t("profile.form52")),1),De,(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[23]||(t[23]=e=>$t.root.child_birth2=e),onInput:t[24]||(t[24]=e=>wt.filterInput("child_birth2",e)),type:"text",placeholder:e.$t("profile.form53")},null,40,Je),[[r.Jo,$t.root.child_birth2]]),Ae]),$t.root.child_birth2?((0,l.uX)(),(0,l.CE)("span",Ge,(0,i.v_)(e.$t("login.arround"))+(0,i.v_)(e.toAge($t.root.child_birth2))+(0,i.v_)(e.$t("login.old"))+"~"+(0,i.v_)(e.toAge($t.root.child_birth))+(0,i.v_)(e.$t("login.old")),1)):(0,l.Q3)("",!0)]),Me,(0,l.Lk)("div",Te,[(0,l.Lk)("div",je,[(0,l.Lk)("label",Ke,(0,i.v_)(e.$t("profile.form54")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[25]||(t[25]=e=>$t.root.learner_habit=e),onInput:t[26]||(t[26]=e=>wt.filterInput("learner_habit",e)),placeholder:e.$t("profile.form54")},null,40,Se),[[r.Jo,$t.root.learner_habit]])]),(0,l.Lk)("div",Be,[(0,l.Lk)("label",qe,(0,i.v_)(e.$t("profile.form55")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[27]||(t[27]=e=>$t.root.share=e),onInput:t[28]||(t[28]=e=>wt.filterInput("share",e)),placeholder:e.$t("profile.form56")},null,40,Oe),[[r.Jo,$t.root.share]])]),(0,l.Lk)("div",Ze,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form57")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[29]||(t[29]=e=>$t.root.ask=e),onInput:t[30]||(t[30]=e=>wt.filterInput("ask",e)),placeholder:e.$t("profile.form58")},null,40,Pe),[[r.Jo,$t.root.ask]])]),(0,l.Lk)("div",ze,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form59")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":t[31]||(t[31]=e=>$t.root.price=e),onInput:t[32]||(t[32]=e=>wt.filterInput("price",e)),placeholder:e.$t("profile.form60")},null,40,He),[[r.Jo,$t.root.price]])])]),(0,l.Lk)("div",Ye,[(0,l.Lk)("label",et,(0,i.v_)(e.$t("profile.form61")),1),(0,l.bo)((0,l.Lk)("textarea",{id:"note","onUpdate:modelValue":t[33]||(t[33]=e=>$t.root.note=e),onInput:t[34]||(t[34]=e=>wt.filterInput("note",e)),rows:"5",cols:"30",placeholder:e.$t("profile.form62")},null,40,tt),[[r.Jo,$t.root.note]])]),$t.root.note&&$t.root.note.length<20?((0,l.uX)(),(0,l.CE)("div",ot,[(0,l.Lk)("div",lt,(0,i.v_)(e.$t("profile.form63"))+(0,i.v_)(20-$t.root.note.length)+(0,i.v_)(e.$t("profile.form64")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form65")),1)])):(0,l.Q3)("",!0),$t.root.note&&$t.root.note.length>=20?((0,l.uX)(),(0,l.CE)("div",it,[(0,l.Lk)("div",rt,(0,i.v_)(e.$t("profile.form66")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form67")),1)])):(0,l.Q3)("",!0)]),o.emailVerified||"email"!==$t.root.login_method?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",at,[(0,l.eW)("note: 您的Email尚未驗證"),(0,l.Lk)("button",{class:"ui button",onClick:t[35]||(t[35]=t=>e.$emit("resendVerificationEmail"))},"按此重發驗證信")])),wt.isValid($t.root)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",st,[(0,l.eW)("note: "+(0,i.v_)(e.$t("profile.form68")),1),nt,(0,l.eW)((0,i.v_)(e.$t("profile.form69")),1)]))],512),[[r.aG,$t.editing]]),$t.isNew?((0,l.uX)(),(0,l.CE)("p",dt,[(0,l.bo)((0,l.Lk)("input",{class:"ui checkbox",type:"checkbox","onUpdate:modelValue":t[36]||(t[36]=e=>$t.agree=e)},null,512),[[r.lH,$t.agree]]),(0,l.eW)((0,i.v_)(e.$t("profile.form70")),1),(0,l.bF)(Ct,{target:"_blank",to:"/privacy-policy"},{default:(0,l.k6)((()=>[(0,l.eW)((0,i.v_)(e.$t("profile.form71")),1)])),_:1})])):(0,l.Q3)("",!0),(0,l.Lk)("div",ut,[(0,l.Lk)("a",{class:(0,i.C4)(["ui large blue button",{disabled:!wt.isValid($t.root)||!o.emailVerified&&"email"===$t.root.login_method}]),onClick:t[37]||(t[37]=(...e)=>wt.updateFlag&&wt.updateFlag(...e))},[$t.isNew?((0,l.uX)(),(0,l.CE)("span",ht,[pt,(0,l.eW)((0,i.v_)(e.$t("login.raise_flag")),1)])):((0,l.uX)(),(0,l.CE)("span",ct,[ft,(0,l.eW)((0,i.v_)(e.$t("login.update_flag")),1)]))],2),$t.isNew?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(Ct,{key:0,class:"ui large green button",to:"/flag/"+o.uid},{default:(0,l.k6)((()=>[mt,(0,l.eW)((0,i.v_)(e.$t("login.check_flag")),1),gt])),_:1},8,["to"])),$t.isNew?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",{key:1,class:"ui large red button",onClick:t[38]||(t[38]=(...e)=>wt.confirmDelete&&wt.confirmDelete(...e))},[kt,(0,l.eW)((0,i.v_)(e.$t("login.delete_flag")),1)]))]),vt,_t,bt,Lt])):(0,l.Q3)("",!0)])}o(4114),o(4603),o(7566),o(8721);var wt=o(2134),Ct=o(9034),yt=o(1090),Ut=o(6808),It=o(4161),Nt=o(6886),Et={name:"MyFlag",mixins:[Ct.A],props:["uid","user","emailVerified","email","mySearch","provider","photoURL","isInApp"],components:{Card:yt.A},metaInfo:{title:"$t('login.fg')"},data(){return{fileInput:null,fileUploaded:!1,agree:!1,root:{latlngColumn:"23.5330,121.0654"},local:{},map:null,marker:null,isNew:!0,editing:!1}},emits:["loginGoogle","locate"],watch:{uid(e){e&&this.fetchUserData()}},mounted(){this.uid?this.fetchUserData():this.$router.push("/")},methods:{handleFileChange(e){const t=e.target.files[0];t&&(this.fileInput=t,this.fileUploaded=!0)},exportData(){console.log("匯出資料");const e={name:this.root.name,email:this.root.email,address:this.root.address,connect_me:this.root.connect_me,site:this.root.site,site2:this.root.site2,learner_birth:this.root.learner_birth,learner_habit:this.root.learner_habit,latlngColumn:this.root.latlngColumn,child_birth:this.root.child_birth||"",child_birth2:this.root.child_birth2||"",share:this.root.share,ask:this.root.ask,price:this.root.price,note:this.root.note};console.log(e);const t=new Blob([JSON.stringify(e)],{type:"application/json"}),o=URL.createObjectURL(t),l=document.createElement("a");l.href=o,l.download="data.json",l.click(),URL.revokeObjectURL(o)},importData(){if(!this.fileInput)return void alert("請先選擇檔案");console.log("開始匯入資料");const e=new FileReader;e.onload=e=>{try{const t=JSON.parse(e.target.result),o=["name","email","address","connect_me","learner_birth","learner_habit","share","note"],l=o.filter((e=>!t[e]));if(l.length>0)return void alert(`匯入的資料缺少必要欄位：${l.join(", ")}`);this.root={...this.root,name:t.name,email:t.email,address:t.address,connect_me:t.connect_me,site:t.site||"",site2:t.site2||"",learner_birth:t.learner_birth,learner_habit:t.learner_habit,child_birth:t.child_birth||"",child_birth2:t.child_birth2||"",latlngColumn:t.latlngColumn||"23.5330,121.0654",share:t.share,ask:t.ask||"",price:t.price||"",note:t.note},this.map&&t.latlngColumn&&this.setMapAndMarker(),this.$forceUpdate(),alert("資料匯入成功"),this.fileInput=null,this.fileUploaded=!1,this.$refs.fileInput.value=""}catch(t){console.error("JSON 解析錯誤:",t),alert("匯入的檔案格式不正確，請確認是否為有效的 JSON 檔案")}},e.onerror=()=>{console.error("檔案讀取失敗"),alert("檔案讀取失敗，請重試")},e.readAsText(this.fileInput)},containsKeyword(e){return wt.R.some((t=>e.includes(t)))},filterInput(e,t){this.containsKeyword(t.target.value)?(alert("Input contains forbidden keywords."),this.root[e]=""):this.root[e]=t.target.value},isValid(){if(!this.root.note||this.root.note.length<20)return!1;const e=[this.root.name,this.root.address,this.root.connect_me,this.root.learner_birth,this.root.learner_habit,this.root.share,this.root.note];return e.every((e=>e&&""!==e.trim()))},startEdit(){this.editing=!0,Nt.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/",setTimeout(this.initMap,500),setTimeout(this.setMapAndMarker,1e3),this.root.email||this.fetchUserData()},initMap(){const e=[23.533,121.0654];let t=e;if("string"===typeof this.root.latlngColumn){const e=this.root.latlngColumn.split(",");if(2===e.length){const o=parseFloat(e[0]),l=parseFloat(e[1]);isNaN(o)||isNaN(l)||(t=[o,l])}}this.map=Nt.map("map").setView(t,7),Nt.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),Nt.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/",this.marker=Nt.marker(this.map.getCenter(),{draggable:!0}).addTo(this.map),this.marker.on("dragend",(()=>{const{lat:e,lng:t}=this.marker.getLatLng();this.map.setView({lat:e,lng:t}),this.root.latlngColumn=`${e.toFixed(5)},${t.toFixed(5)}`,this.$forceUpdate()}))},fetchUserData(){const e=(0,It.KR)(Ut.db,"users/"+this.uid);(0,It.Jt)(e).then((e=>{if(e.exists()){this.isNew=!1,this.root=e.val();let t=[...this.user&&this.user.providerData||[]];0===t.length&&(t=[{displayName:(this.root.email||"").split("@")[0]||"Unknown",email:this.root.email,photoURL:this.root.photoURL||"https://we.alearn.org.tw/logo-new.png"}]),this.root.email=this.root.email||this.email,this.root.connect_me=this.root.connect_me||this.email,this.root.name=this.root.name||this.user.name||t[0].displayName||"新朋友",this.root.photoURL=this.root.photoURL||decodeURI(this.user.photoURL)||"https://we.alearn.org.tw/logo-new.png",this.root.login_method=this.root.login_method||"google"}else{console.log("No data available for user: "+this.uid);let e=[...this.user.providerData||[]];0===e.length&&(e=[{displayName:(this.root.email||"").split("@")[0]||"新朋友",email:this.root.email||"",photoURL:this.root.photoURL||"https://we.alearn.org.tw/logo-new.png",login_method:"google"}]),this.root={name:e[0].displayName,uid:this.uid,email:this.email,connect_me:this.email,photoURL:this.root.photoURL,latlngColumn:"23.5330,121.0654",note:"",login_method:this.root.login_method||"google"},this.isNew=!0}})).catch((e=>{console.error(e),console.log("No data available for user: "+this.uid),console.log(this.user);let t=[...this.user&&this.user.providerData||[]];0===t.length&&(t=[{displayName:(this.root.email||"").split("@")[0]||"新朋友",email:this.root.email||"",photoURL:this.root.photoURL||"https://we.alearn.org.tw/logo-new.png"}]),this.root={name:t[0].displayName,uid:this.uid,email:this.email,connect_me:this.email,photoURL:this.root.photoURL,latlngColumn:"23.5330,121.0654",note:"",login_method:this.root.login_method||"google"},this.isNew=!0}))},setMapAndMarker(){if(this.map&&this.marker){const e=[23.533,121.0654];let t=e;if(this.root&&"string"===typeof this.root.latlngColumn){const e=this.root.latlngColumn.split(",");if(2===e.length){const o=parseFloat(e[0]),l=parseFloat(e[1]);isNaN(o)||isNaN(l)||(t=[o,l])}}const o=Nt.latLng(t[0],t[1]);this.map.setView(o,7),this.marker.setLatLng(o)}},longTimeNoSee(){if(!this.root.lastUpdate)return 1/0;const e=(new Date).getTime();return(e-this.root.lastUpdate)/1e3/3600/24/365.25},tooDetail:function(e){return!!e&&!!e.match(/(號|樓|F|f)/)},updateFlag:function(){if(this.root.email=this.email||"",this.root.uid=this.uid||"",this.root.photoURL=this.photoURL||"",this.root.lastUpdate=(new Date).getTime(),this.emailVerified||"email"!==this.root.login_method||alert("Email尚未驗證"),this.isNew){if(!this.agree)return void window.alert(this.$t("login.agree_pr"));console.log("new2"),this.isNew=!1,this.editing=!1,(0,It.hZ)((0,It.KR)(Ut.db,"users/"+this.uid),this.root).then(alert(this.$t("login.raise_sucess")))}else this.isNew=!1,this.editing=!1,(0,It.hZ)((0,It.KR)(Ut.db,"users/"+this.uid),this.root).then(alert(this.$t("login.update_sucess")));this.$emit("locate",this.root,!1)},confirmDelete(){window.confirm(this.$t("login.delete_confirm2"))&&this.deleteFlag()},deleteFlag(){const e=this.uid;(0,It.TF)((0,It.KR)(Ut.db,"users/"+e)).then((()=>(0,It.Jt)(Ut.sY))).then((t=>{const o=t.val();let l=[...o];const i=l.map(((t,o)=>(t.members=(t.members||[]).filter((t=>t!==e)),(0,It.hZ)((0,It.KR)(Ut.db,"groups/"+o+"/members"),t.members))));return Promise.all(i)})).then((()=>{alert(this.$t("login.delete_confirm3")),this.root={},this.$emit("logout")})).catch((e=>{alert(this.$t("login.delete_failed")+e.message)}))},loginFB:function(){this.$emit("loginFB")},locate:function(e,t){this.$emit("locate",e,t)},addBook:function(e){console.log(e),this.$emit("addBook",e)},loginGoogle:function(){this.$emit("loginGoogle")}}},Xt=o(1241);const Qt=(0,Xt.A)(Et,[["render",$t],["__scopeId","data-v-5f15a1ab"]]);var Rt=Qt}}]);
//# sourceMappingURL=profile.351a3c9c.js.map