"use strict";(self["webpackChunkauto20_next"]=self["webpackChunkauto20_next"]||[]).push([[138],{4048:function(e,o,t){t.r(o),t.d(o,{default:function(){return No}});var l=t(6768),i=t(4232),r=t(5130);const a=e=>((0,l.Qi)("data-v-91471c9c"),e=e(),(0,l.jt)(),e),s={class:"hello"},n={key:0},d={key:1,class:"ui divider"},u={key:2},p={key:3},h={key:4},f={class:"ui grid container"},c={key:0,class:"ui stackable two column row"},m={class:"ten wide column"},g={class:"ui fluid card container"},k={key:0,class:"filler"},v={class:"six wide column"},_=a((()=>(0,l.Lk)("i",{class:"edit icon"},null,-1))),L={key:0},b={key:1},$={key:1,class:"filler"},w={key:5,class:"ui container"},y={key:0,class:"ui warning message"},C={class:"header"},U={key:0},E={class:"ui form error warning success",id:"main-form"},N={class:"ui header"},I={class:"sub header"},X=a((()=>(0,l.Lk)("br",null,null,-1))),Q=a((()=>(0,l.Lk)("i",{class:"red star"},null,-1))),V={class:"ui dividing header"},W={class:"field"},R={class:"required"},x=["placeholder"],F={class:"required"},D=["placeholder"],J={key:0,class:"ui error message"},A={class:"header"},G=a((()=>(0,l.Lk)("br",null,null,-1))),T={href:"https://www.google.com.tw/chrome/browser/desktop/",target:"_blank"},K={key:1,class:"ui warning message"},M={class:"header"},q={class:"ui header"},B={class:"sub header"},j=a((()=>(0,l.Lk)("div",{id:"map",style:{height:"300px"}},null,-1))),S=a((()=>(0,l.Lk)("div",{class:"ui divider"},null,-1))),Z={class:"field"},P={class:"two fields"},z={class:"field"},H=["placeholder"],O={key:0},Y=["href"],ee=["src","title","alt"],oe={class:"field"},te=["placeholder"],le={key:0},ie=["href"],re=["src","title","alt"],ae={class:"two fields"},se={class:"field"},ne={class:"required"},de=["placeholder"],ue={class:"field"},pe=["placeholder"],he={class:"ui dividing header"},fe={class:"field"},ce={value:""},me=["value"],ge={class:"field"},ke={value:""},ve=["value"],_e={class:"required"},Le=["placeholder"],be={key:0},$e={key:1,class:"ui warning message"},we={class:"header"},ye={key:2,class:"ui error message"},Ce={class:"header"},Ue={class:"field"},Ee=["placeholder"],Ne=a((()=>(0,l.Lk)("br",null,null,-1))),Ie={key:0},Xe=a((()=>(0,l.Lk)("div",{class:"ui divider"},null,-1))),Qe={style:{"margin-left":"15px"}},Ve=a((()=>(0,l.Lk)("br",null,null,-1))),We=["placeholder"],Re=a((()=>(0,l.Lk)("br",null,null,-1))),xe={key:1},Fe=a((()=>(0,l.Lk)("div",{class:"ui divider"},null,-1))),De={class:"three fields"},Je={class:"field"},Ae={class:"required"},Ge=["placeholder"],Te={class:"field"},Ke={class:"required"},Me=["placeholder"],qe={class:"field"},Be=["placeholder"],je={class:"field"},Se=["placeholder"],Ze={class:"field"},Pe={class:"required"},ze=["placeholder"],He={key:0,class:"ui warning message"},Oe={class:"header"},Ye={key:1,class:"ui success message"},eo={class:"header"},oo={key:3,class:"warning"},to={key:4,class:"warning"},lo=a((()=>(0,l.Lk)("i",{class:"red star"},null,-1))),io={key:1},ro={class:"ui vertical buttons"},ao={key:0},so=a((()=>(0,l.Lk)("i",{class:"flag icon"},null,-1))),no={key:1},uo=a((()=>(0,l.Lk)("i",{class:"flag icon"},null,-1))),po=a((()=>(0,l.Lk)("i",{class:"user icon"},null,-1))),ho=a((()=>(0,l.Lk)("i",{class:"chevron right icon"},null,-1))),fo=a((()=>(0,l.Lk)("i",{class:"delete icon"},null,-1))),co=a((()=>(0,l.Lk)("br",null,null,-1))),mo=a((()=>(0,l.Lk)("br",null,null,-1))),go=a((()=>(0,l.Lk)("br",null,null,-1))),ko=a((()=>(0,l.Lk)("br",null,null,-1)));function vo(e,o,t,a,vo,_o){const Lo=(0,l.g2)("router-link"),bo=(0,l.g2)("card");return(0,l.uX)(),(0,l.CE)("div",s,[t.isInApp?((0,l.uX)(),(0,l.CE)("p",n,(0,i.v_)(e.$t("login.isapp")),1)):(0,l.Q3)("",!0),(0,l.bo)((0,l.Lk)("p",null,[(0,l.eW)((0,i.v_)(e.$t("profile.announce1")),1),(0,l.bF)(Lo,{target:"_blank",to:"/privacy-policy"},{default:(0,l.k6)((()=>[(0,l.eW)((0,i.v_)(e.$t("profile.announce2")),1)])),_:1}),(0,l.eW)((0,i.v_)(e.$t("profile.announce3")),1)],512),[[r.aG,vo.isNew]]),vo.isNew?((0,l.uX)(),(0,l.CE)("div",d)):(0,l.Q3)("",!0),vo.isNew?((0,l.uX)(),(0,l.CE)("br",u)):(0,l.Q3)("",!0),vo.isNew?((0,l.uX)(),(0,l.CE)("br",p)):(0,l.Q3)("",!0),vo.isNew?((0,l.uX)(),(0,l.CE)("br",h)):(0,l.Q3)("",!0),(0,l.Lk)("div",f,[vo.editing?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",c,[(0,l.bo)((0,l.Lk)("div",m,[(0,l.bo)((0,l.Lk)("div",g,[(0,l.bF)(bo,{h:vo.root,full:!0,book:e.book,onLocate:_o.locate,onAddBook:_o.addBook,onLoginGoogle:_o.loginGoogle,uid:t.uid},null,8,["h","book","onLocate","onAddBook","onLoginGoogle","uid"])],512),[[r.aG,!vo.isNew&&!vo.editing]])],512),[[r.aG,!vo.isNew]]),vo.isNew?((0,l.uX)(),(0,l.CE)("div",k)):(0,l.Q3)("",!0),(0,l.Lk)("div",v,[(0,l.bo)((0,l.Lk)("div",{class:"ui massive green button",onClick:o[0]||(o[0]=(...e)=>_o.startEdit&&_o.startEdit(...e))},[_,(0,l.eW)((0,i.v_)(e.$t("profile.push")),1),vo.isNew?((0,l.uX)(),(0,l.CE)("span",L,(0,i.v_)(e.$t("profile.start")),1)):((0,l.uX)(),(0,l.CE)("span",b,(0,i.v_)(e.$t("profile.edit")),1))],512),[[r.aG,t.uid&&!vo.editing]])]),vo.isNew?((0,l.uX)(),(0,l.CE)("div",$)):(0,l.Q3)("",!0)]))]),vo.editing?((0,l.uX)(),(0,l.CE)("div",w,[_o.longTimeNoSee()>.25?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("div",C,(0,i.v_)(e.$t("profile.update1")),1),_o.longTimeNoSee()>.25?((0,l.uX)(),(0,l.CE)("span",U,(0,i.v_)(e.$t("profile.update2")),1)):(0,l.Q3)("",!0)])):(0,l.Q3)("",!0),(0,l.bo)((0,l.Lk)("form",E,[(0,l.Lk)("h2",N,(0,i.v_)(e.$t("profile.fillform")),1),(0,l.Lk)("div",I,[(0,l.eW)((0,i.v_)(e.$t("profile.form1")),1),X,(0,l.eW)((0,i.v_)(e.$t("profile.form2")),1),Q,(0,l.eW)((0,i.v_)(e.$t("profile.form3")),1)]),(0,l.Lk)("h4",V,(0,i.v_)(e.$t("profile.form4")),1),(0,l.Lk)("div",W,[(0,l.Lk)("label",R,(0,i.v_)(e.$t("profile.form5")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=e=>vo.root.name=e),onInput:o[2]||(o[2]=e=>_o.filterInput("name",e)),placeholder:e.$t("profile.form6")},null,40,x),[[r.Jo,vo.root.name]])]),(0,l.Lk)("div",{class:(0,i.C4)(["field",{error:vo.root.address&&("undefined,undefined"==vo.root.latlngColumn||"36.778261,-119.4179324"==vo.root.latlngColumn)}])},[(0,l.Lk)("label",F,(0,i.v_)(e.$t("profile.form7")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[3]||(o[3]=e=>vo.root.address=e),onInput:o[4]||(o[4]=e=>_o.filterInput("address",e)),placeholder:e.$t("profile.form8")},null,40,D),[[r.Jo,vo.root.address,void 0,{trim:!0}]]),!vo.root.address||"undefined,undefined"!=vo.root.latlngColumn&&"36.778261,-119.4179324"!=vo.root.latlngColumn?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",J,[(0,l.Lk)("div",A,(0,i.v_)(e.$t("profile.form9")),1),(0,l.Lk)("p",null,[(0,l.eW)((0,i.v_)(e.$t("profile.form10")),1),G,(0,l.eW)((0,i.v_)(e.$t("profile.form11")),1),(0,l.Lk)("a",T,(0,i.v_)(e.$t("profile.form12")),1),(0,l.eW)((0,i.v_)(e.$t("profile.form13")),1)])])),_o.tooDetail(vo.root.address)?((0,l.uX)(),(0,l.CE)("div",K,[(0,l.Lk)("div",M,(0,i.v_)(e.$t("profile.form14")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form15")),1)])):(0,l.Q3)("",!0)],2),(0,l.Lk)("h4",q,[(0,l.eW)((0,i.v_)(e.$t("profile.form16")),1),(0,l.Lk)("div",B,(0,i.v_)(e.$t("profile.form17"))+"："+(0,i.v_)(vo.root.latlngColumn),1)]),j,S,(0,l.Lk)("div",Z,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form18")),1),(0,l.Lk)("div",P,[(0,l.Lk)("div",z,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[5]||(o[5]=e=>vo.root.site=e),onInput:o[6]||(o[6]=e=>_o.filterInput("site",e)),placeholder:e.$t("profile.form19")},null,40,H),[[r.Jo,vo.root.site]]),vo.root.site?((0,l.uX)(),(0,l.CE)("span",O,[(0,l.Lk)("a",{href:vo.root.site,target:"_blank"},[(0,l.Lk)("img",{src:"https://www.google.com/s2/favicons?domain="+vo.root.site,title:e.$t("profile.form19"),alt:e.$t("profile.form19")},null,8,ee),(0,l.eW)((0,i.v_)(e.$t("profile.form20")),1)],8,Y)])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",oe,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[7]||(o[7]=e=>vo.root.site2=e),onInput:o[8]||(o[8]=e=>_o.filterInput("site2",e)),placeholder:e.$t("profile.form21")},null,40,te),[[r.Jo,vo.root.site2]]),vo.root.site2?((0,l.uX)(),(0,l.CE)("span",le,[(0,l.Lk)("a",{href:vo.root.site2,target:"_blank"},[(0,l.Lk)("img",{src:"https://www.google.com/s2/favicons?domain="+vo.root.site2,title:e.$t("profile.form22"),alt:e.$t("profile.form22")},null,8,re),(0,l.eW)((0,i.v_)(e.$t("profile.form20")),1)],8,ie)])):(0,l.Q3)("",!0)])])]),(0,l.Lk)("div",ae,[(0,l.Lk)("div",se,[(0,l.Lk)("label",ne,(0,i.v_)(e.$t("profile.form23")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":o[9]||(o[9]=e=>vo.root.connect_me=e),onInput:o[10]||(o[10]=e=>_o.filterInput("connect_me",e)),placeholder:e.$t("profile.form24")},null,40,de),[[r.Jo,vo.root.connect_me]])]),(0,l.Lk)("div",ue,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form25")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":o[11]||(o[11]=e=>vo.root.freetime=e),onInput:o[12]||(o[12]=e=>_o.filterInput("freetime",e)),placeholder:e.$t("profile.form26")},null,40,pe),[[r.Jo,vo.root.freetime]])])]),(0,l.Lk)("h4",he,(0,i.v_)(e.$t("profile.form27")),1),(0,l.Lk)("div",fe,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form28")),1),(0,l.bo)((0,l.Lk)("select",{class:"selectpicker","onUpdate:modelValue":o[13]||(o[13]=e=>vo.root.learner_role=e)},[(0,l.Lk)("option",ce,"-- "+(0,i.v_)(e.$t("profile.form29"))+" --",1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)([e.$t("profile.form30"),e.$t("profile.form31"),e.$t("profile.form32"),e.$t("profile.form33"),e.$t("profile.form34"),e.$t("profile.form35"),e.$t("profile.form36")],(e=>((0,l.uX)(),(0,l.CE)("option",{value:e},(0,i.v_)(e),9,me)))),256))],512),[[r.u1,vo.root.learner_role]])]),(0,l.Lk)("div",ge,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form37")),1),(0,l.bo)((0,l.Lk)("select",{class:"selectpicker","onUpdate:modelValue":o[14]||(o[14]=e=>vo.root.learner_type=e)},[(0,l.Lk)("option",ke,"-- "+(0,i.v_)(e.$t("profile.form38"))+" --",1),((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)([e.$t("profile.form39"),e.$t("profile.form40"),e.$t("profile.form41"),e.$t("profile.form42")],(e=>((0,l.uX)(),(0,l.CE)("option",{value:e},(0,i.v_)(e),9,ve)))),256))],512),[[r.u1,vo.root.learner_type]])]),(0,l.Lk)("div",{class:(0,i.C4)(["field",{error:e.badAge(vo.root.learner_birth),warning:!vo.root.learner_birth}])},[(0,l.Lk)("label",_e,(0,i.v_)(e.$t("profile.form43")),1),(0,l.bo)((0,l.Lk)("input",{type:"text","onUpdate:modelValue":o[15]||(o[15]=e=>vo.root.learner_birth=e),onInput:o[16]||(o[16]=e=>_o.filterInput("learner_birth",e)),placeholder:e.$t("profile.form44")},null,40,Le),[[r.Jo,vo.root.learner_birth]])],2),vo.root.learner_birth?((0,l.uX)(),(0,l.CE)("span",be,(0,i.v_)(e.$t("profile.form45"))+(0,i.v_)(e.toAge(vo.root.learner_birth))+(0,i.v_)(e.$t("login.old")),1)):(0,l.Q3)("",!0),vo.root.learner_birth?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",$e,[(0,l.Lk)("div",we,(0,i.v_)(e.$t("profile.form46")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form47")),1)])),e.badAge(vo.root.learner_birth)?((0,l.uX)(),(0,l.CE)("div",ye,[(0,l.Lk)("div",Ce,(0,i.v_)(e.$t("profile.form48")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form49")),1)])):(0,l.Q3)("",!0),(0,l.Lk)("div",Ue,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form50")),1),(0,l.Lk)("span",null,[(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[17]||(o[17]=e=>vo.root.child_birth=e),onInput:o[18]||(o[18]=e=>_o.filterInput("child_birth",e)),type:"text",placeholder:e.$t("profile.form51")},null,40,Ee),[[r.Jo,vo.root.child_birth]]),Ne,vo.root.child_birth?((0,l.uX)(),(0,l.CE)("span",Ie,(0,i.v_)(e.$t("profile.form45"))+(0,i.v_)(e.toAge(vo.root.child_birth))+(0,i.v_)(e.$t("login.old")),1)):(0,l.Q3)("",!0),Xe,(0,l.Lk)("span",Qe,[(0,l.eW)((0,i.v_)(e.$t("profile.form52")),1),Ve,(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[19]||(o[19]=e=>vo.root.child_birth2=e),onInput:o[20]||(o[20]=e=>_o.filterInput("child_birth2",e)),type:"text",placeholder:e.$t("profile.form53")},null,40,We),[[r.Jo,vo.root.child_birth2]]),Re]),vo.root.child_birth2?((0,l.uX)(),(0,l.CE)("span",xe,(0,i.v_)(e.$t("login.arround"))+(0,i.v_)(e.toAge(vo.root.child_birth2))+(0,i.v_)(e.$t("login.old"))+"~"+(0,i.v_)(e.toAge(vo.root.child_birth))+(0,i.v_)(e.$t("login.old")),1)):(0,l.Q3)("",!0)]),Fe,(0,l.Lk)("div",De,[(0,l.Lk)("div",Je,[(0,l.Lk)("label",Ae,(0,i.v_)(e.$t("profile.form54")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[21]||(o[21]=e=>vo.root.learner_habit=e),onInput:o[22]||(o[22]=e=>_o.filterInput("learner_habit",e)),placeholder:e.$t("profile.form54")},null,40,Ge),[[r.Jo,vo.root.learner_habit]])]),(0,l.Lk)("div",Te,[(0,l.Lk)("label",Ke,(0,i.v_)(e.$t("profile.form55")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[23]||(o[23]=e=>vo.root.share=e),onInput:o[24]||(o[24]=e=>_o.filterInput("share",e)),placeholder:e.$t("profile.form56")},null,40,Me),[[r.Jo,vo.root.share]])]),(0,l.Lk)("div",qe,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form57")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[25]||(o[25]=e=>vo.root.ask=e),onInput:o[26]||(o[26]=e=>_o.filterInput("ask",e)),placeholder:e.$t("profile.form58")},null,40,Be),[[r.Jo,vo.root.ask]])]),(0,l.Lk)("div",je,[(0,l.Lk)("label",null,(0,i.v_)(e.$t("profile.form59")),1),(0,l.bo)((0,l.Lk)("input",{"onUpdate:modelValue":o[27]||(o[27]=e=>vo.root.price=e),onInput:o[28]||(o[28]=e=>_o.filterInput("price",e)),placeholder:e.$t("profile.form60")},null,40,Se),[[r.Jo,vo.root.price]])])]),(0,l.Lk)("div",Ze,[(0,l.Lk)("label",Pe,(0,i.v_)(e.$t("profile.form61")),1),(0,l.bo)((0,l.Lk)("textarea",{id:"note","onUpdate:modelValue":o[29]||(o[29]=e=>vo.root.note=e),onInput:o[30]||(o[30]=e=>_o.filterInput("note",e)),rows:"5",cols:"30",placeholder:e.$t("profile.form62")},null,40,ze),[[r.Jo,vo.root.note]])]),vo.root.note&&vo.root.note.length<20?((0,l.uX)(),(0,l.CE)("div",He,[(0,l.Lk)("div",Oe,(0,i.v_)(e.$t("profile.form63"))+(0,i.v_)(20-vo.root.note.length)+(0,i.v_)(e.$t("profile.form64")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form65")),1)])):(0,l.Q3)("",!0),vo.root.note&&vo.root.note.length>=20?((0,l.uX)(),(0,l.CE)("div",Ye,[(0,l.Lk)("div",eo,(0,i.v_)(e.$t("profile.form66")),1),(0,l.Lk)("p",null,(0,i.v_)(e.$t("profile.form67")),1)])):(0,l.Q3)("",!0)]),t.emailVerified||"email"!==vo.root.login_method?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",oo,[(0,l.eW)("note: 您的Email尚未驗證"),(0,l.Lk)("button",{class:"ui button",onClick:o[31]||(o[31]=o=>e.$emit("resendVerificationEmail"))},"按此重發驗證信")])),_o.isValid(vo.root)?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",to,[(0,l.eW)("note: "+(0,i.v_)(e.$t("profile.form68")),1),lo,(0,l.eW)((0,i.v_)(e.$t("profile.form69")),1)]))],512),[[r.aG,vo.editing]]),vo.isNew?((0,l.uX)(),(0,l.CE)("p",io,[(0,l.bo)((0,l.Lk)("input",{class:"ui checkbox",type:"checkbox","onUpdate:modelValue":o[32]||(o[32]=e=>vo.agree=e)},null,512),[[r.lH,vo.agree]]),(0,l.eW)((0,i.v_)(e.$t("profile.form70")),1),(0,l.bF)(Lo,{target:"_blank",to:"/privacy-policy"},{default:(0,l.k6)((()=>[(0,l.eW)((0,i.v_)(e.$t("profile.form71")),1)])),_:1})])):(0,l.Q3)("",!0),(0,l.Lk)("div",ro,[(0,l.Lk)("a",{class:(0,i.C4)(["ui large blue button",{disabled:!_o.isValid(vo.root)||!t.emailVerified&&"email"===vo.root.login_method}]),onClick:o[33]||(o[33]=(...e)=>_o.updateFlag&&_o.updateFlag(...e))},[vo.isNew?((0,l.uX)(),(0,l.CE)("span",ao,[so,(0,l.eW)((0,i.v_)(e.$t("login.raise_flag")),1)])):((0,l.uX)(),(0,l.CE)("span",no,[uo,(0,l.eW)((0,i.v_)(e.$t("login.update_flag")),1)]))],2),vo.isNew?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.Wv)(Lo,{key:0,class:"ui large green button",to:"/flag/"+t.uid},{default:(0,l.k6)((()=>[po,(0,l.eW)((0,i.v_)(e.$t("login.check_flag")),1),ho])),_:1},8,["to"])),vo.isNew?(0,l.Q3)("",!0):((0,l.uX)(),(0,l.CE)("div",{key:1,class:"ui large red button",onClick:o[34]||(o[34]=(...e)=>_o.confirmDelete&&_o.confirmDelete(...e))},[fo,(0,l.eW)((0,i.v_)(e.$t("login.delete_flag")),1)]))]),co,mo,go,ko])):(0,l.Q3)("",!0)])}t(4114);var _o=t(2134),Lo=t(9034),bo=t(2662),$o=t(6808),wo=t(4161),yo=t(6886),Co={name:"MyFlag",mixins:[Lo.A],props:["uid","user","emailVerified","email","mySearch","provider","photoURL","isInApp"],components:{Card:bo.A},metaInfo:{title:"$t('login.fg')"},data(){return{agree:!1,root:{latlngColumn:"23.5330,121.0654"},local:{},map:null,marker:null,isNew:!0,editing:!1}},emits:["loginGoogle","locate"],watch:{uid(e){e&&this.fetchUserData()}},mounted(){this.uid?this.fetchUserData():this.$router.push("/")},methods:{containsKeyword(e){return _o.R.some((o=>e.includes(o)))},filterInput(e,o){this.containsKeyword(o.target.value)?(alert("Input contains forbidden keywords."),this.root[e]=""):this.root[e]=o.target.value},isValid(){if(!this.root.note||this.root.note.length<20)return!1;const e=[this.root.name,this.root.address,this.root.connect_me,this.root.learner_birth,this.root.learner_habit,this.root.share,this.root.note];return e.every((e=>e&&""!==e.trim()))},startEdit(){this.editing=!0,yo.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/",setTimeout(this.initMap,500),setTimeout(this.setMapAndMarker,1e3),this.root.email||this.fetchUserData()},initMap(){const e=[23.533,121.0654];let o=e;if("string"===typeof this.root.latlngColumn){const e=this.root.latlngColumn.split(",");if(2===e.length){const t=parseFloat(e[0]),l=parseFloat(e[1]);isNaN(t)||isNaN(l)||(o=[t,l])}}this.map=yo.map("map").setView(o,7),yo.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),yo.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/",this.marker=yo.marker(this.map.getCenter(),{draggable:!0}).addTo(this.map),this.marker.on("dragend",(()=>{const{lat:e,lng:o}=this.marker.getLatLng();this.map.setView({lat:e,lng:o}),this.root.latlngColumn=`${e.toFixed(5)},${o.toFixed(5)}`,this.$forceUpdate()}))},fetchUserData(){const e=(0,wo.KR)($o.db,"users/"+this.uid);(0,wo.Jt)(e).then((e=>{if(e.exists()){this.isNew=!1,this.root=e.val();let o=[...this.user&&this.user.providerData||[]];0===o.length&&(o=[{displayName:(this.root.email||"").split("@")[0]||"Unknown",email:this.root.email,photoURL:this.root.photoURL||"https://we.alearn.org.tw/logo-new.png"}]),this.root.email=this.root.email||this.email,this.root.connect_me=this.root.connect_me||this.email,this.root.name=this.root.name||this.user.name||o[0].displayName||"新朋友",this.root.photoURL=this.root.photoURL||decodeURI(this.user.photoURL)||"https://we.alearn.org.tw/logo-new.png",this.root.login_method=this.root.login_method||"google"}else{console.log("No data available for user: "+this.uid);let e=[...this.user.providerData||[]];0===e.length&&(e=[{displayName:(this.root.email||"").split("@")[0]||"新朋友",email:this.root.email||"",photoURL:this.root.photoURL||"https://we.alearn.org.tw/logo-new.png",login_method:"google"}]),this.root={name:e[0].displayName,uid:this.uid,email:this.email,connect_me:this.email,photoURL:this.root.photoURL,latlngColumn:"23.5330,121.0654",note:"",login_method:this.root.login_method||"google"},this.isNew=!0}})).catch((e=>{console.error(e),console.log("No data available for user: "+this.uid),console.log(this.user);let o=[...this.user&&this.user.providerData||[]];0===o.length&&(o=[{displayName:(this.root.email||"").split("@")[0]||"新朋友",email:this.root.email||"",photoURL:this.root.photoURL||"https://we.alearn.org.tw/logo-new.png"}]),this.root={name:o[0].displayName,uid:this.uid,email:this.email,connect_me:this.email,photoURL:this.root.photoURL,latlngColumn:"23.5330,121.0654",note:"",login_method:this.root.login_method||"google"},this.isNew=!0}))},setMapAndMarker(){if(this.map&&this.marker){const e=[23.533,121.0654];let o=e;if(this.root&&"string"===typeof this.root.latlngColumn){const e=this.root.latlngColumn.split(",");if(2===e.length){const t=parseFloat(e[0]),l=parseFloat(e[1]);isNaN(t)||isNaN(l)||(o=[t,l])}}const t=yo.latLng(o[0],o[1]);this.map.setView(t,7),this.marker.setLatLng(t)}},longTimeNoSee(){if(!this.root.lastUpdate)return 1/0;const e=(new Date).getTime();return(e-this.root.lastUpdate)/1e3/3600/24/365.25},tooDetail:function(e){return!!e&&!!e.match(/(號|樓|F|f)/)},updateFlag:function(){if(this.root.email=this.email||"",this.root.uid=this.uid||"",this.root.photoURL=this.photoURL||"",this.root.lastUpdate=(new Date).getTime(),this.emailVerified||"email"!==this.root.login_method||alert("Email尚未驗證"),this.isNew){if(!this.agree)return void window.alert(this.$t("login.agree_pr"));console.log("new2"),this.isNew=!1,this.editing=!1,(0,wo.hZ)((0,wo.KR)($o.db,"users/"+this.uid),this.root).then(alert(this.$t("login.raise_sucess")))}else this.isNew=!1,this.editing=!1,(0,wo.hZ)((0,wo.KR)($o.db,"users/"+this.uid),this.root).then(alert(this.$t("login.update_sucess")));this.$emit("locate",this.root,!1)},confirmDelete(){window.confirm(this.$t("login.delete_confirm2"))&&this.deleteFlag()},deleteFlag(){const e=this.uid;(0,wo.TF)((0,wo.KR)($o.db,"users/"+e)).then((()=>(0,wo.Jt)($o.sY))).then((o=>{const t=o.val();let l=[...t];const i=l.map(((o,t)=>(o.members=(o.members||[]).filter((o=>o!==e)),(0,wo.hZ)((0,wo.KR)($o.db,"groups/"+t+"/members"),o.members))));return Promise.all(i)})).then((()=>{alert(this.$t("login.delete_confirm3")),this.root={},this.$emit("logout")})).catch((e=>{alert(this.$t("login.delete_failed")+e.message)}))},loginFB:function(){this.$emit("loginFB")},locate:function(e,o){this.$emit("locate",e,o)},addBook:function(e){console.log(e),this.$emit("addBook",e)},loginGoogle:function(){this.$emit("loginGoogle")}}},Uo=t(1241);const Eo=(0,Uo.A)(Co,[["render",vo],["__scopeId","data-v-91471c9c"]]);var No=Eo}}]);
//# sourceMappingURL=profile.992a525e.js.map