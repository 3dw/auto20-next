"use strict";(self["webpackChunkauto20_next"]=self["webpackChunkauto20_next"]||[]).push([[583],{5400:function(s,e,i){i.r(e),i.d(e,{default:function(){return z}});var t=i(6768),o=i(4232),r=i(5130);const u=s=>((0,t.Qi)("data-v-28061146"),s=s(),(0,t.jt)(),s),l={class:"hello"},n={key:0,class:"ui container"},a={class:"ui grid"},d={key:0,class:"ui one column row"},h={class:"ui column ui segment"},p=u((()=>(0,t.Lk)("br",{class:"thin-only"},null,-1))),c=u((()=>(0,t.Lk)("i",{class:"edit icon"},null,-1))),g=u((()=>(0,t.Lk)("i",{class:"globe icon"},null,-1))),m={class:"ui form"},k={key:0,class:"field"},b=u((()=>(0,t.Lk)("i",{class:"google icon"},null,-1))),L={class:"field"},v={class:"ui labeled input"},f=u((()=>(0,t.Lk)("label",{class:"ui label"},"輸入社團簡介 ",-1))),w={class:"field"},C={class:"ui grid"},x={class:"row"},R=["src"],y={class:"two column stackable row"},I={class:"column"},N={class:"ui divided list"},E=u((()=>(0,t.Lk)("div",{class:"item left aligned"},"資源：",-1))),X=["href"],_=["src","alt"],G={class:"item ui form"},K={class:"field"},$={class:"ui labeled input"},U=u((()=>(0,t.Lk)("label",{class:"ui label"},"輸入資源名",-1))),W={class:"field"},Z={class:"ui labeled input"},j=u((()=>(0,t.Lk)("label",{class:"ui label"},"輸入資源網址",-1))),H={class:"field"},Q={class:"column"},M={class:"ui divided list"},O=["src"],F={key:0,class:"item ui form"},J={class:"field"},V={class:"ui labeled input"},S=["src"];function B(s,e,i,u,B,D){const A=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",l,[s.users&&s.toList(s.users).length>0&&s.groups[s.$route.params.idx]?((0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",a,[s.groups[s.$route.params.idx].n?((0,t.uX)(),(0,t.CE)("div",d,[(0,t.Lk)("div",h,[(0,t.Lk)("h3",null,"〈"+(0,o.v_)(s.groups[s.$route.params.idx].n)+"〉",1),(0,t.Lk)("p",null,[(0,t.eW)((0,o.v_)(s.groups[s.$route.params.idx].intro),1),p,(0,t.eW)("    "),(0,t.Lk)("a",{onClick:e[0]||(e[0]=e=>s.toggleEdit(s.$route.params.idx))},[c,(0,t.eW)((0,o.v_)(s.edit?"結束":"")+"編輯社團資料",1)])]),(0,t.Lk)("p",null,[(0,t.bF)(A,{class:"ui basic green button",to:"/groups"},{default:(0,t.k6)((()=>[g,(0,t.eW)("探索所有社團")])),_:1})]),(0,t.bo)((0,t.Lk)("div",m,[s.uid?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",k,[(0,t.Lk)("button",{class:"ui orange button",onClick:e[1]||(e[1]=e=>s.loginGoogle())},[b,(0,t.eW)("請先登入")])])),(0,t.Lk)("div",L,[(0,t.Lk)("div",v,[f,(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e[2]||(e[2]=e=>s.newIntro=e),placeholder:"請先輸入社團簡介"},null,512),[[r.Jo,s.newIntro]])])]),(0,t.Lk)("div",w,[(0,t.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!s.newIntro}]),onClick:e[3]||(e[3]=e=>s.addIntro(s.$route.params.idx))},"更新簡介",2)])],512),[[r.aG,s.edit]]),(0,t.Lk)("div",C,[(0,t.Lk)("div",x,[(0,t.Lk)("p",null,[(0,t.eW)("成員："),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.groups[s.$route.params.idx].members,(e=>((0,t.uX)(),(0,t.CE)("span",null,[s.users[e]?((0,t.uX)(),(0,t.Wv)(A,{key:0,to:"/flag/"+e},{default:(0,t.k6)((()=>[(0,t.Lk)("img",{class:"ui avatar",src:s.users[e].photoURL,alt:"users[m].n"},null,8,R)])),_:2},1032,["to"])):(0,t.Q3)("",!0)])))),256)),(0,t.bo)((0,t.Lk)("span",null,[(0,t.bo)((0,t.Lk)("a",{class:"ui green tiny button",onClick:e[4]||(e[4]=e=>s.join(s.groups[s.$route.params.idx].idx))},"我要加入",512),[[r.aG,!s.isMember(s.groups[s.$route.params.idx].idx)]]),(0,t.bo)((0,t.Lk)("a",{class:"ui red tiny button",onClick:e[5]||(e[5]=e=>s.out(s.groups[s.$route.params.idx].idx))},"我要退出",512),[[r.aG,s.isMember(s.groups[s.$route.params.idx].idx)]])],512),[[r.aG,s.uid]])])]),(0,t.Lk)("div",y,[(0,t.Lk)("div",I,[(0,t.Lk)("div",N,[E,((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.groups[s.$route.params.idx].res,((s,e)=>((0,t.uX)(),(0,t.CE)("div",{class:"item left aligned",key:e+s.n+s.href},[(0,t.Lk)("a",{href:s.href,target:"_blank",rel:"noopener noreferrer"},[(0,t.Lk)("img",{src:"http://www.google.com/s2/favicons?domain="+s.href,alt:s.n},null,8,_),(0,t.eW)((0,o.v_)(s.n),1)],8,X)])))),128)),(0,t.bo)((0,t.Lk)("div",G,[(0,t.Lk)("div",K,[(0,t.Lk)("div",$,[U,(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=e=>s.newResName=e),placeholder:"請先輸入資源名"},null,512),[[r.Jo,s.newResName]])])]),(0,t.Lk)("div",W,[(0,t.Lk)("div",Z,[j,(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e[7]||(e[7]=e=>s.newHref=e),placeholder:"請先輸入資源網址"},null,512),[[r.Jo,s.newHref]])])]),(0,t.Lk)("div",H,[(0,t.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!s.newHref||!s.newResName}]),onClick:e[8]||(e[8]=e=>s.addRes(s.$route.params.idx))},"新增資源",2)])],512),[[r.aG,s.uid&&s.edit]])])]),(0,t.Lk)("div",Q,[(0,t.eW)("留言："),(0,t.Lk)("div",M,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.latestChats,((s,e)=>((0,t.uX)(),(0,t.CE)("div",{class:"item",key:e},[(0,t.Lk)("img",{class:"ui avatar",src:s.photoURL},null,8,O),(0,t.eW)((0,o.v_)(s.n)+" : "+(0,o.v_)(s.t),1)])))),128)),s.uid?((0,t.uX)(),(0,t.CE)("div",F,[(0,t.Lk)("div",J,[(0,t.Lk)("div",V,[(0,t.Lk)("img",{class:"ui avatar",src:s.photoURL},null,8,S),(0,t.bo)((0,t.Lk)("input",{class:"input","onUpdate:modelValue":e[9]||(e[9]=e=>s.msg=e),placeholder:"在想什麼嗎?"},null,512),[[r.Jo,s.msg]]),(0,t.Lk)("a",{class:(0,o.C4)(["ui label green button",{disabled:!s.msg}]),onClick:e[10]||(e[10]=e=>s.addChat(s.$route.params.idx))},"留言 ",2)])])])):(0,t.Q3)("",!0)])])])])])])):(0,t.Q3)("",!0)])])):(0,t.Q3)("",!0)])}i(4114);var D=i(4161),A=i(6808),T=(0,t.pM)({name:"GroupsView",props:["photoURL","users","user","uid","mySearch"],metaInfo:{title:"自學社團"},data(){return{edit:!1,newIntro:"",newName:"",newResName:"",newHref:"",msg:"",groups:[]}},computed:{latestChats(){const s=this.$route.params.idx,e=this.groups[s]?.chats||[];return e.slice(-10)}},methods:{toggleEdit(s){this.edit=!this.edit,this.edit?this.newIntro=this.groups[s].intro:this.newIntro=""},toList:s=>s&&"object"===typeof s?Object.values(s):[],loginGoogle:function(){this.$emit("loginGoogle")},isMember(s){return(this.groups[s].members||[]).indexOf(this.uid)>-1},join(s){this.groups[s].members=this.groups[s].members||[],this.groups[s].members.push(this.uid),(0,D.hZ)((0,D.KR)(A.db,"groups"),this.groups).then(console.log("groups更新成功"))},out(s){this.groups[s].members=this.groups[s].members||[],this.groups[s].members=this.groups[s].members.filter((s=>s!==this.uid)),(0,D.hZ)((0,D.KR)(A.db,"groups"),this.groups).then(console.log("groups更新成功"))},searchBy(s,e){return e?s.filter((function(s){return JSON.stringify(s).indexOf(e)>-1})):s},addChat(s){var e={uid:this.uid,n:this.users[this.uid].name?this.users[this.uid].name:"匿名",t:this.msg,photoURL:this.photoURL||"",time:(new Date).getTime()},i=this.groups[s].chats?[...this.groups[s].chats]:[];this.msg&&(i.push(e),this.msg=""),(0,D.hZ)((0,D.KR)(A.db,"groups/"+s+"/chats"),i).then(console.log("groups更新成功"))},addGroup(){this.groups.push({n:this.newName,res:[],chats:[],idx:this.groups.length}),this.newName="",(0,D.hZ)((0,D.KR)(A.db,"groups"),this.groups).then(console.log("groups更新成功"))},addRes(s){this.groups[s].res=this.groups[s].res||[],this.groups[s].res.push({n:this.newResName,href:this.newHref}),this.newResName="",this.newHref="",(0,D.hZ)((0,D.KR)(A.db,"groups"),this.groups).then(console.log("groups更新成功"))},addIntro(s){this.newIntro.trim().length&&(this.groups[s].intro=this.newIntro,(0,D.hZ)((0,D.KR)(A.db,"groups/"+s),this.groups[s]).then((()=>console.log("簡介更新成功"))).catch((s=>{console.error("更新失敗",s)})),this.newIntro="")}},mounted(){(0,D.Zy)(A.sY,(s=>{const e=s.val();this.groups=e||[]}))}}),Y=i(1241);const q=(0,Y.A)(T,[["render",B],["__scopeId","data-v-28061146"]]);var z=q},5119:function(s,e,i){i.r(e),i.d(e,{default:function(){return _}});var t=i(6768),o=i(5130),r=i(4232);const u=s=>((0,t.Qi)("data-v-1a37c874"),s=s(),(0,t.jt)(),s),l={class:"hello"},n={key:0,class:"ui container"},a={class:"ui grid"},d={class:"row ui form"},h={class:"field"},p={class:"ui labeled input"},c=u((()=>(0,t.Lk)("label",{class:"ui label"},"輸入名字",-1))),g={class:"field"},m={class:"ui two stackable column row"},k=u((()=>(0,t.Lk)("br",{class:"thin-only"},null,-1))),b={class:"ui buttons"},L=u((()=>(0,t.Lk)("i",{class:"sign-in icon"},null,-1))),v=["onClick"],f=["onClick"],w={class:"ui grid"},C={class:"row"},x=["src"];function R(s,e,i,u,R,y){const I=(0,t.g2)("router-link");return(0,t.uX)(),(0,t.CE)("div",l,[s.users&&s.toList(s.users).length>0?((0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("div",a,[(0,t.bo)((0,t.Lk)("div",d,[(0,t.Lk)("div",h,[(0,t.Lk)("div",p,[c,(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=e=>s.newName=e),placeholder:"請先輸入社團名"},null,512),[[o.Jo,s.newName]])])]),(0,t.Lk)("div",g,[(0,t.Lk)("a",{class:(0,r.C4)(["ui green button",{disabled:!s.newName}]),onClick:e[1]||(e[1]=e=>s.addGroup())},"創建社團",2)])],512),[[o.aG,s.uid]]),(0,t.Lk)("div",m,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.searchBy(s.groups,s.mySearch),((e,i)=>((0,t.uX)(),(0,t.CE)("div",{class:"ui eight wide column ui segment",key:e.idx},[(0,t.Lk)("h3",null,"〈"+(0,r.v_)(e.n)+"〉",1),(0,t.Lk)("p",null,[(0,t.eW)((0,r.v_)(e.intro),1),k,(0,t.eW)("    ")]),(0,t.Lk)("p",null,[(0,t.Lk)("div",b,[(0,t.bF)(I,{class:"ui basic green button",to:"/group/"+e.idx},{default:(0,t.k6)((()=>[L,(0,t.eW)("前往社團")])),_:2},1032,["to"]),(0,t.bo)((0,t.Lk)("a",{class:"ui green button",onClick:i=>s.join(e.idx)},"我要加入",8,v),[[o.aG,s.uid&&!s.isMember(e.idx)]]),(0,t.bo)((0,t.Lk)("a",{class:"ui red basic button",onClick:i=>s.out(e.idx)},"我要退出",8,f),[[o.aG,s.uid&&s.isMember(e.idx)]])])]),(0,t.Lk)("div",w,[(0,t.Lk)("div",C,[(0,t.Lk)("p",null,[(0,t.eW)("成員："),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.members,(e=>((0,t.uX)(),(0,t.CE)("span",null,[s.users[e]?((0,t.uX)(),(0,t.Wv)(I,{key:0,to:"/flag/"+e},{default:(0,t.k6)((()=>[(0,t.Lk)("img",{class:"ui avatar",src:s.users[e].photoURL,alt:"users[m].n"},null,8,x)])),_:2},1032,["to"])):(0,t.Q3)("",!0)])))),256))])])])])))),128))])])])):(0,t.Q3)("",!0)])}i(4114);var y=i(4161),I=i(6808),N=(0,t.pM)({name:"GroupsView",props:["photoURL","users","user","uid","mySearch"],metaInfo:{title:"自學社團"},data(){return{edit:!1,newIntro:"",newName:"",newResName:"",newHref:"",msg:"",groups:[]}},methods:{toList:s=>s&&"object"===typeof s?Object.values(s):[],loginGoogle:function(){this.$emit("loginGoogle")},isMember(s){return(this.groups[s].members||[]).indexOf(this.uid)>-1},join(s){this.groups[s].members=this.groups[s].members||[],this.groups[s].members.push(this.uid),(0,y.hZ)((0,y.KR)(I.db,"groups"),this.groups).then(console.log("groups更新成功"))},out(s){window.confirm("確定要退出嗎？")&&(this.groups[s].members=this.groups[s].members||[],this.groups[s].members=this.groups[s].members.filter((s=>s!==this.uid)),(0,y.hZ)((0,y.KR)(I.db,"groups"),this.groups).then(console.log("groups更新成功")))},searchBy(s,e){return e?s.filter((function(s){return JSON.stringify(s).indexOf(e)>-1})):s},addChat(s){var e={uid:this.uid,n:(this.user.providerData||[{displayName:"匿名"}])[0].displayName,t:this.msg,photoURL:this.photoURL||"",time:(new Date).getTime()};this.groups[s].chats=this.groups[s].chats||[],this.msg&&(this.groups[s].chats.push(e),this.msg=""),(0,y.hZ)((0,y.KR)(I.db,"groups/"+s),this.g).then(console.log("groups更新成功"))},addGroup(){this.groups.push({n:this.newName,res:[],chats:[],idx:this.groups.length}),this.newName="",(0,y.hZ)((0,y.KR)(I.db,"groups"),this.groups).then(console.log("groups更新成功"))},addRes(s){this.groups[s].res=this.groups[s].res||[],this.groups[s].res.push({n:this.newResName,href:this.newHref}),this.newResName="",this.newHref="",(0,y.hZ)((0,y.KR)(I.db,"groups"),this.groups).then(console.log("groups更新成功"))},addIntro(s){this.groups[s].intro=this.newIntro,this.newIntro="",(0,y.hZ)((0,y.KR)(I.db,"groups"),this.groups).then(console.log("groups更新成功"))}},mounted(){(0,y.Zy)(I.sY,(s=>{const e=s.val();this.groups=e||[]}))}}),E=i(1241);const X=(0,E.A)(N,[["render",R],["__scopeId","data-v-1a37c874"]]);var _=X}}]);
//# sourceMappingURL=groups.b3f8435f.js.map