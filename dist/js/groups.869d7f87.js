"use strict";(self["webpackChunkauto20_next"]=self["webpackChunkauto20_next"]||[]).push([[583],{1436:function(e,s,t){t.r(s),t.d(s,{default:function(){return Z}});var i=t(6768),o=t(4232),r=t(5130);const n={class:"hello"},u={key:0,class:"ui row"},l={class:"sixteen wide column"},a={class:"ui huge buttons"},d={key:1,class:"ui container"},c={class:"ui divided list flex-column-reverse"},p={class:"item form"},h={class:"field"},g={class:"ui labeled input"},m={class:"ui label"},k=["placeholder"],b={class:"field button-field"},v={key:0,class:"popular-resources"},f={class:"ui bulleted list"},L=["href"],_=["src"],w={class:"likes"},$={class:"members-section"},y={style:{position:"relative",top:"0.6em"}},x=["src","alt"],C={class:"buttons-section"},R={class:"ui buttons"},I=["onClick"],E=["onClick"];function X(e,s,t,X,U,K){const N=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",n,[e.uid?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",u,[(0,i.Lk)("div",l,[(0,i.Lk)("div",a,[(0,i.Lk)("button",{class:"ui orange button",onClick:s[0]||(s[0]=(...s)=>e.toggleLogin&&e.toggleLogin(...s))},[s[4]||(s[4]=(0,i.Lk)("i",{class:"lock icon"},null,-1)),(0,i.eW)((0,o.v_)(e.$t("login.login_to_see_data")),1)])])])])),e.users&&e.toList(e.users).length>0?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("div",c,[(0,i.bo)((0,i.Lk)("div",p,[s[5]||(s[5]=(0,i.Lk)("br",null,null,-1)),s[6]||(s[6]=(0,i.Lk)("br",null,null,-1)),(0,i.Lk)("h4",null,(0,o.v_)(e.$t("groups.create_group")),1),(0,i.Lk)("div",h,[(0,i.Lk)("div",g,[(0,i.Lk)("label",m,(0,o.v_)(e.$t("groups.group_name")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=s=>e.newName=s),onInput:s[2]||(s[2]=s=>e.filterInput("newName",s)),placeholder:e.$t("groups.enter_group_name")},null,40,k),[[r.Jo,e.newName]])])]),(0,i.Lk)("div",b,[(0,i.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!e.newName}]),onClick:s[3]||(s[3]=s=>e.addGroup())},(0,o.v_)(e.$t("groups.create_group")),3)])],512),[[r.aG,e.uid&&e.users[e.uid]]]),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.searchBy(e.groups,e.mySearch),(t,n)=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{class:"item",key:t.idx},[(0,i.Lk)("h3",null,"〈"+(0,o.v_)(t.n)+"〉",1),(0,i.Lk)("p",null,[(0,i.eW)((0,o.v_)(t.intro),1),s[7]||(s[7]=(0,i.Lk)("br",{class:"thin-only"},null,-1)),s[8]||(s[8]=(0,i.eW)("    "))]),e.getTopResources(t.res).length>0?((0,i.uX)(),(0,i.CE)("div",v,[(0,i.Lk)("h4",null,[(0,i.eW)((0,o.v_)(e.$t("groups.popular_resources"))+"( Total:",1),s[9]||(s[9]=(0,i.Lk)("i",{class:"book icon"},null,-1)),(0,i.eW)((0,o.v_)((t.res||[]).length)+" "+(0,o.v_)(e.$t("groups.resources"))+" )",1)]),(0,i.Lk)("div",f,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.getTopResources(t.res),t=>((0,i.uX)(),(0,i.CE)("a",{class:"resource-link",key:t.href,href:t.href,target:"_blank"},[(0,i.Lk)("img",{class:"favicon",src:e.getFavicon(t.href)},null,8,_),(0,i.Lk)("span",null,(0,o.v_)(t.n),1),(0,i.Lk)("span",w,"("+(0,o.v_)((t.likes||[]).length),1),s[10]||(s[10]=(0,i.Lk)("i",{class:"red heart icon"},null,-1)),s[11]||(s[11]=(0,i.eW)(")"))],8,L))),128))])])):(0,i.Q3)("",!0),(0,i.Lk)("div",$,[(0,i.Lk)("span",y,(0,o.v_)(e.$t("groups.members")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(t.members,s=>((0,i.uX)(),(0,i.CE)("span",null,[e.isUser(s)?((0,i.uX)(),(0,i.Wv)(N,{key:0,to:"/flag/"+s},{default:(0,i.k6)(()=>[(0,i.Lk)("img",{class:"ui avatar",src:e.users[s].photoURL,alt:e.users[s].name},null,8,x)]),_:2},1032,["to"])):(0,i.Q3)("",!0)]))),256))]),(0,i.Lk)("div",C,[(0,i.Lk)("div",R,[(0,i.bF)(N,{class:"ui basic green button",to:"/group/"+t.idx},{default:(0,i.k6)(()=>[s[12]||(s[12]=(0,i.Lk)("i",{class:"sign-in icon"},null,-1)),(0,i.eW)((0,o.v_)(e.$t("groups.go_group")),1)]),_:2,__:[12]},1032,["to"]),e.isUser(e.uid)&&!e.isMember(t.idx)?((0,i.uX)(),(0,i.CE)("a",{key:0,class:"ui green button",onClick:s=>e.join(t.idx)},(0,o.v_)(e.$t("groups.join_group")),9,I)):(0,i.Q3)("",!0),e.isUser(e.uid)&&e.isMember(t.idx)?((0,i.uX)(),(0,i.CE)("a",{key:1,class:"ui red basic button",onClick:s=>e.out(t.idx)},(0,o.v_)(e.$t("groups.out_group")),9,E)):(0,i.Q3)("",!0)])])])),[[r.aG,!t.hidden]])),128))])])):(0,i.Q3)("",!0)])}t(4114),t(8111),t(2489),t(3579),t(4603),t(7566),t(8721);var U=t(9034),K=t(2134),N=t(4161),G=t(6808),W=(0,i.pM)({mixins:[U.A],name:"GroupsView",props:{uid:{type:String,required:!1},photoURL:{type:String,required:!1},users:{type:Object,required:!1,default:()=>({})},mySearch:{type:String,required:!1}},metaInfo:{title:"$t('login.auto_gp')"},data(){return{edit:!1,newIntro:"",newName:"",newResName:"",newHref:"",msg:"",groups:[]}},watch:{users(e){this.toList(e).length>0&&this.fetchGroupData()}},mounted(){this.uid&&this.fetchGroupData()},methods:{fetchGroupData(){(0,N.Jt)(G.sY).then(e=>{const s=e.val();this.groups=s||[],console.log("Groups data updated:",this.groups)},e=>{console.error("Error fetching group data:",e)})},containsKeyword(e){return K.R.some(s=>e.includes(s))},filterInput(e,s){this.containsKeyword(s.target.value)?(alert("Input contains forbidden keywords."),this[e]=""):this[e]=s.target.value},loginGoogle(e,s){this.$emit("loginGoogle",e,s)},toggleLogin(){this.$emit("toggleLogin")},isUser(e){return e&&this.users[e]&&this.users[e].name},isMember(e){return(this.groups[e].members||[]).indexOf(this.uid)>-1},join(e){this.groups[e].members=this.groups[e].members||[],this.groups[e].members.push(this.uid),(0,N.hZ)((0,N.KR)(G.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},out(e){window.confirm(this.$t("groups.out_confirm"))&&(this.groups[e].members=this.groups[e].members||[],this.groups[e].members=this.groups[e].members.filter(e=>e!==this.uid),(0,N.hZ)((0,N.KR)(G.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess"))))},searchBy(e,s){return s?e.filter(function(e){return JSON.stringify(e).indexOf(s)>-1}):e},addChat(e){var s={uid:this.uid,n:(this.user.providerData||[{displayName:this.$t("login.anoymous")}])[0].displayName,t:this.msg,photoURL:this.photoURL||"",time:(new Date).getTime()};this.groups[e].chats=this.groups[e].chats||[],this.msg&&(this.groups[e].chats.push(s),this.msg=""),(0,N.hZ)((0,N.KR)(G.db,"groups/"+e),this.g).then(console.log(this.$t("groups.update_sucess")))},addGroup(){this.groups.push({n:this.newName,res:[],chats:[],idx:this.groups.length}),this.newName="",(0,N.hZ)((0,N.KR)(G.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},addRes(e){this.groups[e].res=this.groups[e].res||[],this.groups[e].res.push({n:this.newResName,href:this.newHref}),this.newResName="",this.newHref="",(0,N.hZ)((0,N.KR)(G.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},addIntro(e){this.groups[e].intro=this.newIntro,this.newIntro="",(0,N.hZ)((0,N.KR)(G.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},getTopResources(e){return e&&Array.isArray(e)?e.sort((e,s)=>(s.likes||[]).length-(e.likes||[]).length).slice(0,3):[]},getFavicon(e){try{const s=new URL(e).hostname;return`https://www.google.com/s2/favicons?domain=${s}&sz=32`}catch(s){return""}}}}),T=t(1241);const Q=(0,T.A)(W,[["render",X],["__scopeId","data-v-f241afc8"]]);var Z=Q},6858:function(e,s,t){t.r(s),t.d(s,{default:function(){return Re}});var i=t(6768),o=t(4232),r=t(5130);const n={class:"hello"},u={class:"ui center aligned grid"},l={key:0,class:"sixteen wide column"},a={class:"ui huge buttons center aligned"},d={key:1},c={class:"ui center aligned grid"},p={class:"ui column center aligned","ui-if":"groups[$route.params.idx].n"},h={class:"ui raised segment center aligned",style:{"margin-top":"30px","max-width":"800px"}},g={class:"ui header"},m={class:"center aligned"},k={class:"ui form"},b={key:0,class:"field"},v={class:"field"},f={class:"ui labeled input"},L={class:"ui label"},_=["placeholder"],w={class:"field"},$={key:0},y={class:"ui grid center aligned"},x={class:"row"},C={class:"center aligned"},R=["src","alt","title"],I={key:0},E={class:"two column stackable row"},X={class:"column"},U={key:0,class:"ui divided list center aligned"},K={class:"item center aligned"},N={class:"resource-content"},G=["href"],W=["src","alt"],T={class:"resource-buttons"},Q=["onClick"],Z={key:0,class:"heart icon"},F={key:1,class:"heart outline icon"},S={class:"item ui form"},M={class:"ui form"},O={class:"field no-margin no-padding"},J={class:"ui labeled input"},V={class:"ui label"},H=["placeholder"],B={class:"field no-margin no-padding"},j={class:"ui labeled input"},D={class:"ui label"},A=["placeholder"],q={class:"field no-padding"},z={key:1,class:"ui divided list center aligned"},Y={class:"item center aligned"},P=["onClick"],ee=["src","alt"],se={key:0},te={class:"ui labeled input"},ie={class:"ui label"},oe={class:"ui labeled input"},re={class:"ui label"},ne=["placeholder"],ue={class:"column center aligned"},le={class:"ui divided list left aligned"},ae=["src"],de={key:0,class:"item ui form"},ce={class:"field"},pe={class:"ui labeled input"},he=["src"],ge=["placeholder"],me={class:"ui center aligned grid",style:{"margin-top":"20px"}},ke={class:"column"},be={class:"ui buttons"};function ve(e,s,t,ve,fe,Le){const _e=(0,i.g2)("router-link"),we=(0,i.g2)("VueMarkdownIt");return(0,i.uX)(),(0,i.CE)("div",n,[(0,i.Lk)("div",u,[e.uid||e.users&&0!=e.toList(e.users).length?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("div",a,[(0,i.Lk)("button",{class:"ui orange button",onClick:s[0]||(s[0]=(...s)=>e.toggleLogin&&e.toggleLogin(...s))},[s[25]||(s[25]=(0,i.Lk)("i",{class:"google icon"},null,-1)),(0,i.eW)((0,o.v_)(e.$t("login.login_to_see_data")),1)])])])),e.users&&e.toList(e.users).length>0&&e.groups[e.$route.params.idx]&&!e.groups[e.$route.params.idx].hidden?((0,i.uX)(),(0,i.CE)("div",d,[(0,i.Lk)("div",c,[(0,i.Lk)("div",p,[(0,i.Lk)("div",h,[(0,i.Lk)("h3",g,"〈"+(0,o.v_)(e.groups[e.$route.params.idx].n)+"〉",1),(0,i.Lk)("p",m,[(0,i.eW)((0,o.v_)(e.groups[e.$route.params.idx].intro),1),s[27]||(s[27]=(0,i.Lk)("br",{class:"thin-only"},null,-1)),e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("a",{key:0,onClick:s[1]||(s[1]=s=>e.toggleEdit(e.$route.params.idx))},[s[26]||(s[26]=(0,i.Lk)("i",{class:"edit icon"},null,-1)),(0,i.eW)((0,o.v_)(e.edit?e.$t("login.end"):"")+" "+(0,o.v_)(e.$t("group.edit_group")),1)])):(0,i.Q3)("",!0)]),(0,i.bF)(_e,{class:"ui basic green button",to:"/groups"},{default:(0,i.k6)(()=>[s[28]||(s[28]=(0,i.Lk)("i",{class:"globe icon"},null,-1)),(0,i.eW)((0,o.v_)(e.$t("group.explore_groups")),1)]),_:1,__:[28]}),(0,i.bo)((0,i.Lk)("div",k,[e.uid?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",b,[(0,i.Lk)("button",{class:"ui orange button",onClick:s[2]||(s[2]=s=>e.loginGoogle())},[s[29]||(s[29]=(0,i.Lk)("i",{class:"google icon"},null,-1)),(0,i.eW)((0,o.v_)(e.$t("login.login_first")),1)])])),(0,i.Lk)("div",v,[(0,i.Lk)("div",f,[(0,i.Lk)("label",L,(0,o.v_)(e.$t("group.enter_intro")),1),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[3]||(s[3]=s=>e.newIntro=s),onInput:s[4]||(s[4]=s=>e.filterInput("newIntro",s)),placeholder:e.$t("group.enter_intro_first"),rows:"5",style:{width:"100%","font-size":"18px"}},null,40,_),[[r.Jo,e.newIntro]])])]),(0,i.Lk)("div",w,[(0,i.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!e.newIntro}]),onClick:s[5]||(s[5]=s=>e.addIntro(e.$route.params.idx))},(0,o.v_)(e.$t("group.update_intro")),3)])],512),[[r.aG,e.edit]]),0===(e.groups[e.$route.params.idx].members||[]).length?((0,i.uX)(),(0,i.CE)("p",$,[(0,i.Lk)("button",{class:"ui red button",onClick:s[6]||(s[6]=s=>e.hideGroup(e.$route.params.idx))},[s[30]||(s[30]=(0,i.Lk)("i",{class:"delete icon"},null,-1)),(0,i.eW)((0,o.v_)(e.$t("group.delete_group")),1)])])):(0,i.Q3)("",!0),(0,i.Lk)("div",y,[(0,i.Lk)("div",x,[(0,i.Lk)("p",C,[(0,i.eW)((0,o.v_)(e.$t("group.members")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.groups[e.$route.params.idx].members,s=>((0,i.uX)(),(0,i.CE)("span",null,[e.isUser(s)?((0,i.uX)(),(0,i.Wv)(_e,{key:0,to:"/flag/"+s},{default:(0,i.k6)(()=>[(0,i.Lk)("img",{class:"ui avatar",src:e.users[s].photoURL,alt:e.users[s].n,title:e.users[s].n},null,8,R)]),_:2},1032,["to"])):(0,i.Q3)("",!0)]))),256)),e.uid?((0,i.uX)(),(0,i.CE)("span",I,[e.isUser(e.uid)&&!e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("a",{key:0,class:"ui green tiny button",onClick:s[7]||(s[7]=s=>e.join(e.groups[e.$route.params.idx].idx))},(0,o.v_)(e.$t("groups.join_group")),1)):(0,i.Q3)("",!0),e.isUser(e.uid)&&e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("a",{key:1,class:"ui red tiny button",onClick:s[8]||(s[8]=s=>e.out(e.groups[e.$route.params.idx].idx))},(0,o.v_)(e.$t("groups.out_group")),1)):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",E,[(0,i.Lk)("div",X,[e.edit?((0,i.uX)(),(0,i.CE)("div",z,[(0,i.Lk)("div",Y,(0,o.v_)(e.$t("group.resources")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.groups[e.$route.params.idx].res,(t,n)=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{class:"item left aligned",key:n+t.n+t.href},[s[32]||(s[32]=(0,i.Lk)("div",{class:"resource-content"},null,-1)),(0,i.Lk)("a",{onClick:s=>e.toggleEditResource(t,n)},[(0,i.Lk)("img",{src:"http://www.google.com/s2/favicons?domain="+t.href,alt:t.n},null,8,ee),(0,i.eW)((0,o.v_)(t.n),1)],8,P),e.edit&&e.editResourceIndex===n?((0,i.uX)(),(0,i.CE)("div",se,[(0,i.Lk)("div",te,[(0,i.Lk)("label",ie,(0,o.v_)(e.$t("group.enter_resource")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[14]||(s[14]=s=>e.tempResource.n=s),style:{width:"100%","font-size":"20px",padding:"15px"}},null,512),[[r.Jo,e.tempResource.n]])]),(0,i.Lk)("div",oe,[(0,i.Lk)("label",re,(0,o.v_)(e.$t("group.enter_link")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[15]||(s[15]=s=>e.tempResource.href=s),placeholder:e.$t("group.enter_link_first"),style:{width:"100%","font-size":"20px",padding:"15px"}},null,8,ne),[[r.Jo,e.tempResource.href]])]),(0,i.Lk)("a",{class:"ui green button",onClick:s[16]||(s[16]=s=>e.saveResource(e.$route.params.idx))},(0,o.v_)(e.$t("group.save")),1),(0,i.Lk)("a",{class:"ui red button",onClick:s[17]||(s[17]=s=>e.edit=!1)},(0,o.v_)(e.$t("group.cancel")),1)])):(0,i.Q3)("",!0)])),[[r.aG,!t.hidden]])),128))])):((0,i.uX)(),(0,i.CE)("div",U,[(0,i.Lk)("div",K,(0,o.v_)(e.$t("group.resources_sorted")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.sortedResources,(t,n)=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{class:"item center aligned",key:n+t.n+t.href},[(0,i.Lk)("div",N,[(0,i.Lk)("a",{href:t.href,target:"_blank",rel:"noopener noreferrer"},[(0,i.Lk)("img",{src:"http://www.google.com/s2/favicons?domain="+t.href,alt:t.n},null,8,W),(0,i.eW)((0,o.v_)(t.n),1)],8,G),s[31]||(s[31]=(0,i.Lk)("div",{class:"filler"},null,-1))]),(0,i.Lk)("div",T,[e.isUser(e.uid)?((0,i.uX)(),(0,i.CE)("a",{key:0,class:"ui blue button",onClick:s=>e.likeResource(e.$route.params.idx,t.rid)},[(t.likes||[]).includes(e.uid)?((0,i.uX)(),(0,i.CE)("i",Z)):((0,i.uX)(),(0,i.CE)("i",F)),(0,i.eW)((0,o.v_)((t.likes||[]).length)+" "+(0,o.v_)(e.$t("group.likes")),1)],8,Q)):(0,i.Q3)("",!0)])])),[[r.aG,!t.hidden]])),128)),(0,i.bo)((0,i.Lk)("div",S,[(0,i.bo)((0,i.Lk)("div",M,[(0,i.Lk)("div",O,[(0,i.Lk)("div",J,[(0,i.Lk)("label",V,(0,o.v_)(e.$t("group.enter_resource")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[9]||(s[9]=s=>e.newResName=s),onInput:s[10]||(s[10]=s=>e.filterInput("newResName",s)),placeholder:e.$t("group.enter_resource_first")},null,40,H),[[r.Jo,e.newResName]])])]),(0,i.Lk)("div",B,[(0,i.Lk)("div",j,[(0,i.Lk)("label",D,(0,o.v_)(e.$t("group.enter_link")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[11]||(s[11]=s=>e.newHref=s),onInput:s[12]||(s[12]=s=>e.filterInput("newHref",s)),placeholder:e.$t("group.enter_link_first")},null,40,A),[[r.Jo,e.newHref]])])]),(0,i.Lk)("div",q,[(0,i.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!e.newHref||!e.newResName}]),onClick:s[13]||(s[13]=s=>e.addRes(e.$route.params.idx))},(0,o.v_)(e.$t("group.add_resource")),3)])],512),[[r.aG,e.uid]])],512),[[r.aG,e.uid]])]))]),(0,i.bo)((0,i.Lk)("div",ue,[(0,i.eW)((0,o.v_)(e.$t("login.leave_messages")),1),(0,i.Lk)("div",le,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.latestChats,(s,t)=>((0,i.uX)(),(0,i.CE)("div",{class:"item",key:t},[(0,i.Lk)("img",{class:"ui avatar",src:s.photoURL},null,8,ae),(0,i.eW)((0,o.v_)(e.removeBracket(s.n))+" : ",1),(0,i.bF)(we,{source:s.t},null,8,["source"])]))),128)),e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("div",de,[(0,i.Lk)("div",ce,[(0,i.Lk)("div",pe,[(0,i.Lk)("img",{class:"ui avatar",src:e.photoURL},null,8,he),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[18]||(s[18]=s=>e.msg=s),onInput:s[19]||(s[19]=s=>e.filterInput("msg",s)),placeholder:e.$t("group.anything_to_say"),rows:"3",style:{"font-size":"18px",padding:"10px"}},null,40,ge),[[r.Jo,e.msg]]),(0,i.Lk)("a",{class:(0,o.C4)(["ui label green button",{disabled:!e.msg}]),onClick:s[20]||(s[20]=s=>e.addChat(e.$route.params.idx))},(0,o.v_)(e.$t("login.leave_messages")),3)])])])):(0,i.Q3)("",!0)])],512),[[r.aG,!e.edit]])])])])])]),(0,i.Lk)("div",me,[(0,i.Lk)("div",ke,[(0,i.Lk)("div",be,[(0,i.Lk)("button",{class:"ui blue button",onClick:s[21]||(s[21]=(...s)=>e.copyLink&&e.copyLink(...s))},[s[33]||(s[33]=(0,i.Lk)("i",{class:"copy icon"},null,-1)),(0,i.eW)((0,o.v_)(e.$t("group.copy_link")),1)]),(0,i.Lk)("button",{class:"ui facebook button",onClick:s[22]||(s[22]=(...s)=>e.shareToFacebook&&e.shareToFacebook(...s))},s[34]||(s[34]=[(0,i.Lk)("i",{class:"facebook icon"},null,-1),(0,i.eW)("Facebook")])),(0,i.Lk)("button",{class:"ui twitter button",onClick:s[23]||(s[23]=(...s)=>e.shareToTwitter&&e.shareToTwitter(...s))},s[35]||(s[35]=[(0,i.Lk)("i",{class:"twitter icon"},null,-1),(0,i.eW)("Twitter")])),(0,i.Lk)("button",{class:"ui line button",onClick:s[24]||(s[24]=(...s)=>e.shareToLine&&e.shareToLine(...s))},"Line")])])])])):(0,i.Q3)("",!0)])])}t(4114),t(8111),t(2489),t(7588),t(1701),t(3579);var fe=t(9034),Le=t(2134),_e=t(4161),we=t(6808),$e=t(3232),ye=(0,i.pM)({name:"GroupsView",props:["photoURL","users","user","uid","mySearch"],metaInfo:{title:"$t('login.auto_gp')"},mixins:[fe.A],components:{VueMarkdownIt:$e.H},data(){return{edit:!1,newIntro:"",newName:"",newResName:"",newHref:"",msg:"",groups:[],editResourceIndex:1/0,tempResource:{}}},computed:{latestChats(){const e=this.$route.params.idx,s=this.groups[e]?.chats||[];return s.slice(-10)},sortedResources(){const e=this.$route.params.idx;return(this.groups[e]?.res||[]).map((e,s)=>{let t={...e};return t.rid=s,t}).filter(e=>!this.mySearch||e.n.indexOf(this.mySearch)>-1||e.href.indexOf(this.mySearch)>-1||e.des&&e.des.indexOf(this.mySearch)>-1).sort((e,s)=>{const t=e.likes?e.likes.length:0,i=s.likes?s.likes.length:0;return i-t})}},methods:{removeBracket(e){return e.replace(/\(.*?\)/g,"")},hideGroup(e){confirm(this.$t("group.delete_confirm"))&&(this.groups[e].hidden=!0,(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e+"/hidden"),!0).then(console.log(this.$t("groups.update_sucess"))).catch(e=>{console.error(this.$t("groups.update_failed"),e)}))},containsKeyword(e){return Le.R.some(s=>e.includes(s))},filterInput(e,s){this.containsKeyword(s.target.value)?(alert("Input contains forbidden keywords."),this[e]=""):this[e]=s.target.value},toggleEdit(e){this.isMember(e)?(this.edit=!this.edit,this.edit?this.newIntro=this.groups[e].intro:this.newIntro=""):alert(this.$t("groups.edit_permission"))},loginGoogle(e,s){this.$emit("loginGoogle",e,s)},toggleLogin(){this.$emit("toggleLogin")},isUser(e){return e&&this.users[e]&&this.users[e].note},isMember(e){return(this.groups[e].members||[]).indexOf(this.uid)>-1},join(e){this.groups[e].members=this.groups[e].members||[],this.groups[e].members.push(this.uid),(0,_e.hZ)((0,_e.KR)(we.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},out(e){this.groups[e].members=this.groups[e].members||[],this.groups[e].members=this.groups[e].members.filter(e=>e!==this.uid),(0,_e.hZ)((0,_e.KR)(we.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},searchBy(e,s){return s?e.filter(function(e){return JSON.stringify(e).indexOf(s)>-1}):e},likeResource(e,s){const t=this.groups[e].res[s].likes||[],i=t.includes(this.uid);i?this.groups[e].res[s].likes=t.filter(e=>e!==this.uid):this.groups[e].res[s].likes.push(this.uid),(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e+"/res/"+s),this.groups[e].res[s]).then(()=>{console.log(this.$t("groups.update_sucess"))}).catch(e=>{console.error(this.$t("groups.update_failed"),e)})},addChat(e){if(!this.msg.trim())return void alert(this.$t("group.empty_message"));var s={uid:this.uid,n:this.users[this.uid].name?this.users[this.uid].name:this.$t("login.anoymous"),t:this.msg,photoURL:this.photoURL||"",time:(new Date).getTime()},t=this.groups[e].chats?[...this.groups[e].chats]:[];this.msg&&(t.push(s),this.msg=""),(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e+"/chats"),t).then(console.log(this.$t("groups.update_sucess"))).catch(e=>{console.error(this.$t("groups.update_failed"),e)});const i=this.groups[e].members||[];i.forEach(s=>{if(s!==this.uid){let t="/group/"+e;this.addNotificationByUid(s,"在社團「"+this.groups[e].n+"」有新留言",t)}})},addRes(e){this.groups[e].res=this.groups[e].res||[],this.groups[e].res.push({n:this.newResName,href:this.newHref,likes:[this.uid]}),this.newResName="",this.newHref="",(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e+"/res"),this.groups[e].res).then(console.log(this.$t("groups.update_sucess")));const s=this.groups[e].members||[];s.forEach(s=>{if(s!==this.uid){let t="/group/"+e;this.addNotificationByUid(s,"在社團「"+this.groups[e].n+"」有新增社團資源",t)}})},hideResource(e,s){this.groups[e].res[s].hidden=!0,(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e+"/res/"+s+"/hidden"),!0).then(()=>{console.log(this.$t("groups.update_sucess"))}).catch(e=>{console.error(this.$t("groups.update_failed"),e)})},showResource(e,s){this.groups[e].res[s].hidden=!1,(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e+"/res/"+s+"/hidden"),!1).then(()=>{console.log(this.$t("groups.update_sucess"))}).catch(e=>{console.error(this.$t("groups.update_failed"),e)})},toggleEditResource(e,s){this.tempResource=JSON.parse(JSON.stringify(e)),this.editResourceIndex=s,this.edit=!0},saveResource(e){this.groups[e].res[this.editResourceIndex]={...this.tempResource},(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e+"/res/"+this.editResourceIndex),this.groups[e].res[this.editResourceIndex]).then(()=>{console.log(this.$t("groups.update_sucess")),this.editResourceIndex=1/0}).catch(e=>{console.error(this.$t("groups.update_failed"),e)}),this.edit=!1},addNotificationByUid(e,s,t){const i={date:(new Date).toISOString(),from:"systemdef",text:s,route:t,isRead:!1},o=(0,_e.KR)(we.db,"users/"+e+"/notifications");(0,_e.VC)(o,i).then(()=>{console.log("notification created")}).catch(e=>{console.error("Error creating notification:",e)})},addGroup(){this.groups.push({n:this.newName,res:[],chats:[],idx:this.groups.length}),this.newName="",(0,_e.hZ)((0,_e.KR)(we.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},addIntro(e){this.newIntro.trim().length&&(this.groups[e].intro=this.newIntro,(0,_e.hZ)((0,_e.KR)(we.db,"groups/"+e),this.groups[e]).then(()=>console.log(this.$t("login.update_sucess"))).catch(e=>{console.error(this.$t("login.update_failed"),e)}),this.newIntro="")},copyLink(){const e=window.location.href;navigator.clipboard.writeText(e).then(()=>{alert(this.$t("group.link_copied"))}).catch(e=>{console.error("無法複製連結:",e)})},shareToFacebook(){const e=encodeURIComponent(window.location.href),s=encodeURIComponent(this.groups[this.$route.params.idx].n);window.open(`https://www.facebook.com/sharer/sharer.php?u=${e}&quote=${s}`,"_blank")},shareToTwitter(){const e=encodeURIComponent(window.location.href),s=encodeURIComponent(this.groups[this.$route.params.idx].n);window.open(`https://twitter.com/intent/tweet?url=${e}&text=${s}`,"_blank")},shareToLine(){const e=encodeURIComponent(window.location.href);window.open(`https://social-plugins.line.me/lineit/share?url=${e}`,"_blank")}},mounted(){(0,_e.Zy)(we.sY,e=>{const s=e.val();this.groups=s||[]})}}),xe=t(1241);const Ce=(0,xe.A)(ye,[["render",ve],["__scopeId","data-v-a1ff3bfa"]]);var Re=Ce}}]);
//# sourceMappingURL=groups.869d7f87.js.map