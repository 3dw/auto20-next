"use strict";(self["webpackChunkauto20_next"]=self["webpackChunkauto20_next"]||[]).push([[583],{6312:function(e,s,t){t.r(s),t.d(s,{default:function(){return Ne}});var i=t(6768),o=t(4232),r=t(5130);const u=e=>((0,i.Qi)("data-v-2e2d435d"),e=e(),(0,i.jt)(),e),n={class:"hello"},l={class:"ui center aligned grid"},a={key:0,class:"sixteen wide column"},d={class:"ui huge buttons center aligned"},p=u((()=>(0,i.Lk)("i",{class:"google icon"},null,-1))),c={key:1},g={class:"ui center aligned grid"},h={class:"ui column center aligned","ui-if":"groups[$route.params.idx].n"},m={class:"ui raised segment center aligned",style:{"margin-top":"30px","max-width":"800px"}},k={class:"ui header"},b={class:"center aligned"},v=u((()=>(0,i.Lk)("br",{class:"thin-only"},null,-1))),f=u((()=>(0,i.Lk)("i",{class:"edit icon"},null,-1))),_=u((()=>(0,i.Lk)("i",{class:"globe icon"},null,-1))),L={class:"ui form"},$={key:0,class:"field"},w=u((()=>(0,i.Lk)("i",{class:"google icon"},null,-1))),x={class:"field"},y={class:"ui labeled input"},R={class:"ui label"},C=["placeholder"],I={class:"field"},E={key:0},X=u((()=>(0,i.Lk)("i",{class:"delete icon"},null,-1))),N={class:"ui grid center aligned"},U={class:"row"},K={class:"center aligned"},G=["src","alt"],Q={key:0},W={class:"two column stackable row"},Z={class:"column"},S={key:0,class:"ui divided list center aligned"},O={class:"item center aligned"},j={class:"resource-content"},J=["href"],M=["src","alt"],H=u((()=>(0,i.Lk)("div",{class:"filler"},null,-1))),V={class:"resource-buttons"},F=["onClick"],D=u((()=>(0,i.Lk)("i",{class:"thumbs up icon"},null,-1))),z={key:1,class:"red"},B=u((()=>(0,i.Lk)("i",{class:"heart icon"},null,-1))),q={key:1,class:"ui divided list center aligned"},A={class:"item center aligned"},T=u((()=>(0,i.Lk)("div",{class:"resource-content"},null,-1))),Y=["onClick"],P=["src","alt"],ee={key:0},se={class:"ui labeled input"},te={class:"ui label"},ie={class:"ui labeled input"},oe={class:"ui label"},re=["placeholder"],ue={class:"item ui form"},ne={class:"field no-margin no-padding"},le={class:"ui labeled input"},ae={class:"ui label"},de=["placeholder"],pe={class:"field no-margin no-padding"},ce={class:"ui labeled input"},ge={class:"ui label"},he=["placeholder"],me={class:"field no-padding"},ke={class:"column center aligned"},be={class:"ui divided list left aligned"},ve=["src"],fe={key:0,class:"item ui form"},_e={class:"field"},Le={class:"ui labeled input"},$e=["src"],we=["placeholder"];function xe(e,s,t,u,xe,ye){const Re=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",n,[(0,i.Lk)("div",l,[e.uid||e.users&&0!=e.toList(e.users).length?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",a,[(0,i.Lk)("div",d,[(0,i.Lk)("button",{class:"ui orange button",onClick:s[0]||(s[0]=(...s)=>e.toggleLogin&&e.toggleLogin(...s))},[p,(0,i.eW)((0,o.v_)(e.$t("login.login_to_see_data")),1)])])])),e.users&&e.toList(e.users).length>0&&e.groups[e.$route.params.idx]&&!e.groups[e.$route.params.idx].hidden?((0,i.uX)(),(0,i.CE)("div",c,[(0,i.Lk)("div",g,[(0,i.Lk)("div",h,[(0,i.Lk)("div",m,[(0,i.Lk)("h3",k,"〈"+(0,o.v_)(e.groups[e.$route.params.idx].n)+"〉",1),(0,i.Lk)("p",b,[(0,i.eW)((0,o.v_)(e.groups[e.$route.params.idx].intro),1),v,e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("a",{key:0,onClick:s[1]||(s[1]=s=>e.toggleEdit(e.$route.params.idx))},[f,(0,i.eW)((0,o.v_)(e.edit?e.$t("login.end"):"")+" "+(0,o.v_)(e.$t("group.edit_group")),1)])):(0,i.Q3)("",!0)]),(0,i.bF)(Re,{class:"ui basic green button",to:"/groups"},{default:(0,i.k6)((()=>[_,(0,i.eW)((0,o.v_)(e.$t("group.explore_groups")),1)])),_:1}),(0,i.bo)((0,i.Lk)("div",L,[e.uid?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",$,[(0,i.Lk)("button",{class:"ui orange button",onClick:s[2]||(s[2]=s=>e.loginGoogle())},[w,(0,i.eW)((0,o.v_)(e.$t("login.login_first")),1)])])),(0,i.Lk)("div",x,[(0,i.Lk)("div",y,[(0,i.Lk)("label",R,(0,o.v_)(e.$t("group.enter_intro")),1),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":s[3]||(s[3]=s=>e.newIntro=s),onInput:s[4]||(s[4]=s=>e.filterInput("newIntro",s)),placeholder:e.$t("group.enter_intro_first"),rows:"5",style:{width:"100%","font-size":"18px"}},null,40,C),[[r.Jo,e.newIntro]])])]),(0,i.Lk)("div",I,[(0,i.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!e.newIntro}]),onClick:s[5]||(s[5]=s=>e.addIntro(e.$route.params.idx))},(0,o.v_)(e.$t("group.update_intro")),3)])],512),[[r.aG,e.edit]]),0===(e.groups[e.$route.params.idx].members||[]).length?((0,i.uX)(),(0,i.CE)("p",E,[(0,i.Lk)("button",{class:"ui red button",onClick:s[6]||(s[6]=s=>e.hideGroup(e.$route.params.idx))},[X,(0,i.eW)((0,o.v_)(e.$t("group.delete_group")),1)])])):(0,i.Q3)("",!0),(0,i.Lk)("div",N,[(0,i.Lk)("div",U,[(0,i.Lk)("p",K,[(0,i.eW)("成員："),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.groups[e.$route.params.idx].members,(s=>((0,i.uX)(),(0,i.CE)("span",null,[e.isUser(s)?((0,i.uX)(),(0,i.Wv)(Re,{key:0,to:"/flag/"+s},{default:(0,i.k6)((()=>[(0,i.Lk)("img",{class:"ui avatar",src:e.users[s].photoURL,alt:e.users[s].n},null,8,G)])),_:2},1032,["to"])):(0,i.Q3)("",!0)])))),256)),e.uid?((0,i.uX)(),(0,i.CE)("span",Q,[e.isUser(e.uid)&&!e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("a",{key:0,class:"ui green tiny button",onClick:s[7]||(s[7]=s=>e.join(e.groups[e.$route.params.idx].idx))},(0,o.v_)(e.$t("groups.join_group")),1)):(0,i.Q3)("",!0),e.isUser(e.uid)&&e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("a",{key:1,class:"ui red tiny button",onClick:s[8]||(s[8]=s=>e.out(e.groups[e.$route.params.idx].idx))},(0,o.v_)(e.$t("groups.out_group")),1)):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",W,[(0,i.Lk)("div",Z,[e.edit?((0,i.uX)(),(0,i.CE)("div",q,[(0,i.Lk)("div",A,(0,o.v_)(e.$t("group.resources")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.groups[e.$route.params.idx].res,((t,u)=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{class:"item left aligned",key:u+t.n+t.href},[T,(0,i.Lk)("a",{onClick:s=>e.toggleEditResource(t,u)},[(0,i.Lk)("img",{src:"http://www.google.com/s2/favicons?domain="+t.href,alt:t.n},null,8,P),(0,i.eW)((0,o.v_)(t.n),1)],8,Y),e.edit&&e.editResourceIndex===u?((0,i.uX)(),(0,i.CE)("div",ee,[(0,i.Lk)("div",se,[(0,i.Lk)("label",te,(0,o.v_)(e.$t("group.enter_resource")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[9]||(s[9]=s=>e.tempResource.n=s),style:{width:"100%","font-size":"20px",padding:"15px"}},null,512),[[r.Jo,e.tempResource.n]])]),(0,i.Lk)("div",ie,[(0,i.Lk)("label",oe,(0,o.v_)(e.$t("group.enter_link")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[10]||(s[10]=s=>e.tempResource.href=s),placeholder:e.$t("group.enter_link_first"),style:{width:"100%","font-size":"20px",padding:"15px"}},null,8,re),[[r.Jo,e.tempResource.href]])]),(0,i.Lk)("a",{class:"ui green button",onClick:s[11]||(s[11]=s=>e.saveResource(e.$route.params.idx))},(0,o.v_)(e.$t("group.save")),1),(0,i.Lk)("a",{class:"ui red button",onClick:s[12]||(s[12]=s=>e.edit=!1)},(0,o.v_)(e.$t("group.cancel")),1)])):(0,i.Q3)("",!0)])),[[r.aG,!t.hidden]]))),128)),(0,i.bo)((0,i.Lk)("div",ue,[(0,i.Lk)("div",ne,[(0,i.Lk)("div",le,[(0,i.Lk)("label",ae,(0,o.v_)(e.$t("group.enter_resource")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[13]||(s[13]=s=>e.newResName=s),onInput:s[14]||(s[14]=s=>e.filterInput("newResName",s)),placeholder:e.$t("group.enter_resource_first"),style:{width:"100%","font-size":"20px",padding:"15px"}},null,40,de),[[r.Jo,e.newResName]])])]),(0,i.Lk)("div",pe,[(0,i.Lk)("div",ce,[(0,i.Lk)("label",ge,(0,o.v_)(e.$t("group.enter_link")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[15]||(s[15]=s=>e.newHref=s),onInput:s[16]||(s[16]=s=>e.filterInput("newHref",s)),placeholder:e.$t("group.enter_link_first"),style:{width:"100%","font-size":"20px",padding:"15px"}},null,40,he),[[r.Jo,e.newHref]])])]),(0,i.Lk)("div",me,[(0,i.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!e.newHref||!e.newResName}]),onClick:s[17]||(s[17]=s=>e.addRes(e.$route.params.idx))},(0,o.v_)(e.$t("group.add_resource")),3)])],512),[[r.aG,e.uid&&!e.edit]])])):((0,i.uX)(),(0,i.CE)("div",S,[(0,i.Lk)("div",O,(0,o.v_)(e.$t("group.resources")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.sortedResources,((s,t)=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{class:"item center aligned",key:t+s.n+s.href},[(0,i.Lk)("div",j,[(0,i.Lk)("a",{href:s.href,target:"_blank",rel:"noopener noreferrer"},[(0,i.Lk)("img",{src:"http://www.google.com/s2/favicons?domain="+s.href,alt:s.n},null,8,M),(0,i.eW)((0,o.v_)(s.n),1)],8,J),H]),(0,i.Lk)("div",V,[e.isUser(e.uid)&&!(s.likes||[]).includes(e.uid)?(0,i.bo)(((0,i.uX)(),(0,i.CE)("a",{key:0,class:"ui blue button",onClick:s=>e.likeResource(e.$route.params.idx,t)},[D,(0,i.eW)((0,o.v_)(e.$t("group.like")),1)],8,F)),[[r.aG,!e.edit]]):(0,i.Q3)("",!0),s.likes&&s.likes.length>0?((0,i.uX)(),(0,i.CE)("span",z,[B,(0,i.eW)((0,o.v_)(s.likes.length)+" "+(0,o.v_)(e.$t("group.likes")),1)])):(0,i.Q3)("",!0)])])),[[r.aG,!s.hidden]]))),128))]))]),(0,i.bo)((0,i.Lk)("div",ke,[(0,i.eW)((0,o.v_)(e.$t("login.leave_messages")),1),(0,i.Lk)("div",be,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.latestChats,((e,s)=>((0,i.uX)(),(0,i.CE)("div",{class:"item",key:s},[(0,i.Lk)("img",{class:"ui avatar",src:e.photoURL},null,8,ve),(0,i.eW)((0,o.v_)(e.n)+" : "+(0,o.v_)(e.t),1)])))),128)),e.isMember(e.groups[e.$route.params.idx].idx)?((0,i.uX)(),(0,i.CE)("div",fe,[(0,i.Lk)("div",_e,[(0,i.Lk)("div",Le,[(0,i.Lk)("img",{class:"ui avatar",src:e.photoURL},null,8,$e),(0,i.bo)((0,i.Lk)("input",{class:"input","onUpdate:modelValue":s[18]||(s[18]=s=>e.msg=s),onInput:s[19]||(s[19]=s=>e.filterInput("msg",s)),placeholder:e.$t("group.anything_to_say"),style:{"font-size":"18px",padding:"10px"}},null,40,we),[[r.Jo,e.msg]]),(0,i.Lk)("a",{class:(0,o.C4)(["ui label green button",{disabled:!e.msg}]),onClick:s[20]||(s[20]=s=>e.addChat(e.$route.params.idx))},(0,o.v_)(e.$t("login.leave_messages")),3)])])])):(0,i.Q3)("",!0)])],512),[[r.aG,!e.edit]])])])])])])])):(0,i.Q3)("",!0)])])}t(4114);var ye=t(2134),Re=t(4161),Ce=t(6808),Ie=(0,i.pM)({name:"GroupsView",props:["photoURL","users","user","uid","mySearch"],metaInfo:{title:"$t('login.auto_gp')"},data(){return{edit:!1,newIntro:"",newName:"",newResName:"",newHref:"",msg:"",groups:[],editResourceIndex:1/0,tempResource:{}}},computed:{latestChats(){const e=this.$route.params.idx,s=this.groups[e]?.chats||[];return s.slice(-10)},sortedResources(){const e=this.$route.params.idx;return(this.groups[e]?.res||[]).filter((e=>!this.mySearch||e.n.indexOf(this.mySearch)>-1||e.href.indexOf(this.mySearch)>-1||e.des&&e.des.indexOf(this.mySearch)>-1)).sort(((e,s)=>{const t=e.likes?e.likes.length:0,i=s.likes?s.likes.length:0;return i-t}))}},methods:{hideGroup(e){confirm(this.$t("group.delete_confirm"))&&(this.groups[e].hidden=!0,(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e+"/hidden"),!0).then(console.log(this.$t("groups.update_sucess"))).catch((e=>{console.error(this.$t("groups.update_failed"),e)})))},containsKeyword(e){return ye.R.some((s=>e.includes(s)))},filterInput(e,s){this.containsKeyword(s.target.value)?(alert("Input contains forbidden keywords."),this[e]=""):this[e]=s.target.value},toggleEdit(e){this.isMember(e)?(this.edit=!this.edit,this.edit?this.newIntro=this.groups[e].intro:this.newIntro=""):alert(this.$t("groups.edit_permission"))},toList:e=>e&&"object"===typeof e?Object.values(e):[],loginGoogle(e,s){this.$emit("loginGoogle",e,s)},toggleLogin(){this.$emit("toggleLogin")},isUser(e){return e&&this.users[e]},isMember(e){return(this.groups[e].members||[]).indexOf(this.uid)>-1},join(e){this.groups[e].members=this.groups[e].members||[],this.groups[e].members.push(this.uid),(0,Re.hZ)((0,Re.KR)(Ce.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},out(e){this.groups[e].members=this.groups[e].members||[],this.groups[e].members=this.groups[e].members.filter((e=>e!==this.uid)),(0,Re.hZ)((0,Re.KR)(Ce.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},searchBy(e,s){return s?e.filter((function(e){return JSON.stringify(e).indexOf(s)>-1})):e},likeResource(e,s){this.groups[e].res[s].likes=this.groups[e].res[s].likes||[],(this.groups[e].res[s].likes||[]).includes(this.uid)||(this.groups[e].res[s].likes.push(this.uid),(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e+"/res/"+s),this.groups[e].res[s]).then((()=>{console.log(this.$t("groups.update_sucess"))})).catch((e=>{console.error(this.$t("groups.update_failed"),e)})))},addChat(e){var s={uid:this.uid,n:this.users[this.uid].name?this.users[this.uid].name:this.$t("login.anoymous"),t:this.msg,photoURL:this.photoURL||"",time:(new Date).getTime()},t=this.groups[e].chats?[...this.groups[e].chats]:[];this.msg&&(t.push(s),this.msg=""),(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e+"/chats"),t).then(console.log(this.$t("groups.update_sucess")));const i=this.groups[e].members||[];i.forEach((s=>{if(s!==this.uid){let t="/group/"+e;this.addNotificationByUid(s,"在社團「"+this.groups[e].n+"」有新留言",t)}}))},addRes(e){this.groups[e].res=this.groups[e].res||[],this.groups[e].res.push({n:this.newResName,href:this.newHref,likes:[this.uid]}),this.newResName="",this.newHref="",(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e),this.groups[e]).then(console.log(this.$t("groups.update_sucess")));const s=this.groups[e].members||[];s.forEach((s=>{if(s!==this.uid){let t="/group/"+e;this.addNotificationByUid(s,"在社團「"+this.groups[e].n+"」有新增社團資源",t)}}))},hideResource(e,s){this.groups[e].res[s].hidden=!0,(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e+"/res/"+s+"/hidden"),!0).then((()=>{console.log(this.$t("groups.update_sucess"))})).catch((e=>{console.error(this.$t("groups.update_failed"),e)}))},showResource(e,s){this.groups[e].res[s].hidden=!1,(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e+"/res/"+s+"/hidden"),!1).then((()=>{console.log(this.$t("groups.update_sucess"))})).catch((e=>{console.error(this.$t("groups.update_failed"),e)}))},toggleEditResource(e,s){this.tempResource=JSON.parse(JSON.stringify(e)),this.editResourceIndex=s,this.edit=!0},saveResource(e){this.groups[e].res[this.editResourceIndex]={...this.tempResource},(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e+"/res/"+this.editResourceIndex),this.groups[e].res[this.editResourceIndex]).then((()=>{console.log(this.$t("groups.update_sucess")),this.editResourceIndex=1/0})).catch((e=>{console.error(this.$t("groups.update_failed"),e)})),this.edit=!1},addNotificationByUid(e,s,t){const i={date:(new Date).toISOString(),from:"systemdef",text:s,route:t,isRead:!1},o=(0,Re.KR)(Ce.db,"users/"+e+"/notifications");(0,Re.VC)(o,i).then((()=>{console.log("notification created")})).catch((e=>{console.error("Error creating notification:",e)}))},addGroup(){this.groups.push({n:this.newName,res:[],chats:[],idx:this.groups.length}),this.newName="",(0,Re.hZ)((0,Re.KR)(Ce.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},addIntro(e){this.newIntro.trim().length&&(this.groups[e].intro=this.newIntro,(0,Re.hZ)((0,Re.KR)(Ce.db,"groups/"+e),this.groups[e]).then((()=>console.log(this.$t("login.update_sucess")))).catch((e=>{console.error(this.$t("login.update_failed"),e)})),this.newIntro="")}},mounted(){(0,Re.Zy)(Ce.sY,(e=>{const s=e.val();this.groups=s||[]}))}}),Ee=t(1241);const Xe=(0,Ee.A)(Ie,[["render",xe],["__scopeId","data-v-2e2d435d"]]);var Ne=Xe},875:function(e,s,t){t.r(s),t.d(s,{default:function(){return Z}});var i=t(6768),o=t(4232),r=t(5130);const u=e=>((0,i.Qi)("data-v-4c940896"),e=e(),(0,i.jt)(),e),n={class:"hello"},l={key:0,class:"ui row"},a={class:"sixteen wide column"},d={class:"ui huge buttons"},p={key:1,class:"ui container"},c={class:"ui grid"},g={class:"ui two stackable column row"},h=u((()=>(0,i.Lk)("br",{class:"thin-only"},null,-1))),m={class:"ui buttons"},k=u((()=>(0,i.Lk)("i",{class:"sign-in icon"},null,-1))),b=["onClick"],v=["onClick"],f={class:"ui grid"},_={class:"row"},L=["src","alt"],$={class:"ui eight wide column form"},w=u((()=>(0,i.Lk)("br",null,null,-1))),x=u((()=>(0,i.Lk)("br",null,null,-1))),y={class:"field"},R={class:"ui labeled input"},C={class:"ui label"},I=["placeholder"],E={class:"field button-field"};function X(e,s,t,u,X,N){const U=(0,i.g2)("router-link");return(0,i.uX)(),(0,i.CE)("div",n,[e.uid?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",l,[(0,i.Lk)("div",a,[(0,i.Lk)("div",d,[(0,i.Lk)("button",{class:"ui orange button",onClick:s[0]||(s[0]=(...s)=>e.toggleLogin&&e.toggleLogin(...s))},(0,o.v_)(e.$t("login.login_to_see_data")),1)])])])),e.users&&e.toList(e.users).length>0?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("div",c,[(0,i.Lk)("div",g,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.searchBy(e.groups,e.mySearch),((s,t)=>(0,i.bo)(((0,i.uX)(),(0,i.CE)("div",{class:"ui eight wide column segment",key:s.idx},[(0,i.Lk)("h3",null,"〈"+(0,o.v_)(s.n)+"〉",1),(0,i.Lk)("p",null,[(0,i.eW)((0,o.v_)(s.intro),1),h,(0,i.eW)("    ")]),(0,i.Lk)("p",null,[(0,i.Lk)("div",m,[(0,i.bF)(U,{class:"ui basic green button",to:"/group/"+s.idx},{default:(0,i.k6)((()=>[k,(0,i.eW)((0,o.v_)(e.$t("groups.go_group")),1)])),_:2},1032,["to"]),e.isUser(e.uid)&&!e.isMember(s.idx)?((0,i.uX)(),(0,i.CE)("a",{key:0,class:"ui green button",onClick:t=>e.join(s.idx)},(0,o.v_)(e.$t("groups.join_group")),9,b)):(0,i.Q3)("",!0),e.isUser(e.uid)&&e.isMember(s.idx)?((0,i.uX)(),(0,i.CE)("a",{key:1,class:"ui red basic button",onClick:t=>e.out(s.idx)},(0,o.v_)(e.$t("groups.out_group")),9,v)):(0,i.Q3)("",!0)])]),(0,i.Lk)("div",f,[(0,i.Lk)("div",_,[(0,i.Lk)("p",null,[(0,i.eW)((0,o.v_)(e.$t("groups.members")),1),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(s.members,(s=>((0,i.uX)(),(0,i.CE)("span",null,[e.isUser(s)?((0,i.uX)(),(0,i.Wv)(U,{key:0,to:"/flag/"+s},{default:(0,i.k6)((()=>[(0,i.Lk)("img",{class:"ui avatar",src:e.users[s].photoURL,alt:e.users[s].name},null,8,L)])),_:2},1032,["to"])):(0,i.Q3)("",!0)])))),256))])])])])),[[r.aG,!s.hidden]]))),128)),(0,i.bo)((0,i.Lk)("div",$,[w,x,(0,i.Lk)("h4",null,(0,o.v_)(e.$t("groups.create_group")),1),(0,i.Lk)("div",y,[(0,i.Lk)("div",R,[(0,i.Lk)("label",C,(0,o.v_)(e.$t("groups.group_name")),1),(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=s=>e.newName=s),onInput:s[2]||(s[2]=s=>e.filterInput("newName",s)),placeholder:e.$t("groups.enter_group_name")},null,40,I),[[r.Jo,e.newName]])])]),(0,i.Lk)("div",E,[(0,i.Lk)("a",{class:(0,o.C4)(["ui green button",{disabled:!e.newName}]),onClick:s[3]||(s[3]=s=>e.addGroup())},(0,o.v_)(e.$t("groups.create_group")),3)])],512),[[r.aG,e.uid&&e.users[e.uid]]])])])])):(0,i.Q3)("",!0)])}t(4114);var N=t(2134),U=t(4161),K=t(6808),G=(0,i.pM)({name:"GroupsView",props:{uid:{type:String,required:!1},photoURL:{type:String,required:!1},users:{type:Object,required:!1,default:()=>({})},mySearch:{type:String,required:!1}},metaInfo:{title:"$t('login.auto_gp')"},data(){return{edit:!1,newIntro:"",newName:"",newResName:"",newHref:"",msg:"",groups:[]}},watch:{users(e){this.toList(e).length>0&&this.fetchGroupData()}},mounted(){this.uid&&this.fetchGroupData()},methods:{fetchGroupData(){(0,U.Jt)(K.sY).then((e=>{const s=e.val();this.groups=s||[],console.log("Groups data updated:",this.groups)}),(e=>{console.error("Error fetching group data:",e)}))},containsKeyword(e){return N.R.some((s=>e.includes(s)))},filterInput(e,s){this.containsKeyword(s.target.value)?(alert("Input contains forbidden keywords."),this[e]=""):this[e]=s.target.value},toList:e=>e&&"object"===typeof e?Object.values(e):[],loginGoogle(e,s){this.$emit("loginGoogle",e,s)},toggleLogin(){this.$emit("toggleLogin")},isUser(e){return e&&this.users[e]&&this.users[e].name},isMember(e){return(this.groups[e].members||[]).indexOf(this.uid)>-1},join(e){this.groups[e].members=this.groups[e].members||[],this.groups[e].members.push(this.uid),(0,U.hZ)((0,U.KR)(K.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},out(e){window.confirm(this.$t("groups.out_confirm"))&&(this.groups[e].members=this.groups[e].members||[],this.groups[e].members=this.groups[e].members.filter((e=>e!==this.uid)),(0,U.hZ)((0,U.KR)(K.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess"))))},searchBy(e,s){return s?e.filter((function(e){return JSON.stringify(e).indexOf(s)>-1})):e},addChat(e){var s={uid:this.uid,n:(this.user.providerData||[{displayName:this.$t("login.anoymous")}])[0].displayName,t:this.msg,photoURL:this.photoURL||"",time:(new Date).getTime()};this.groups[e].chats=this.groups[e].chats||[],this.msg&&(this.groups[e].chats.push(s),this.msg=""),(0,U.hZ)((0,U.KR)(K.db,"groups/"+e),this.g).then(console.log(this.$t("groups.update_sucess")))},addGroup(){this.groups.push({n:this.newName,res:[],chats:[],idx:this.groups.length}),this.newName="",(0,U.hZ)((0,U.KR)(K.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},addRes(e){this.groups[e].res=this.groups[e].res||[],this.groups[e].res.push({n:this.newResName,href:this.newHref}),this.newResName="",this.newHref="",(0,U.hZ)((0,U.KR)(K.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))},addIntro(e){this.groups[e].intro=this.newIntro,this.newIntro="",(0,U.hZ)((0,U.KR)(K.db,"groups"),this.groups).then(console.log(this.$t("groups.update_sucess")))}}}),Q=t(1241);const W=(0,Q.A)(G,[["render",X],["__scopeId","data-v-4c940896"]]);var Z=W}}]);
//# sourceMappingURL=groups.6edf5c08.js.map