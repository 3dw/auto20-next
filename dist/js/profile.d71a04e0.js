"use strict";(self["webpackChunkauto20_next"]=self["webpackChunkauto20_next"]||[]).push([[138],{3867:function(e,l,o){o.r(l),o.d(l,{default:function(){return sl}});var t=o(6768),a=o(5130),s=o(4232);const n=e=>((0,t.Qi)("data-v-2f2fcabc"),e=e(),(0,t.jt)(),e),r={class:"hello"},i={key:0},d={key:2,class:"ui huge buttons"},u=n((()=>(0,t.Lk)("i",{class:"google icon"},null,-1))),c={key:3,class:"ui container"},h={class:"ui warning message"},k=n((()=>(0,t.Lk)("div",{class:"header"},"請立即更新",-1))),p={key:0},L={key:1},m={class:"ui form error warning success",id:"main-form"},g=n((()=>(0,t.Lk)("h2",{class:"ui header"},"請填表",-1))),b=n((()=>(0,t.Lk)("div",{class:"sub header"},[(0,t.eW)("為了讓人真的能找到夥伴"),(0,t.Lk)("br"),(0,t.eW)("有標記紅色星號"),(0,t.Lk)("i",{class:"red star"}),(0,t.eW)("的欄位為必填")],-1))),v=n((()=>(0,t.Lk)("h4",{class:"ui dividing header"},"關於我",-1))),f={class:"field"},_=n((()=>(0,t.Lk)("label",{class:"required"},"名字",-1))),y=n((()=>(0,t.Lk)("label",{class:"required"},"概略地址",-1))),C=["innerHTML"],w={class:"ui error message"},x=n((()=>(0,t.Lk)("div",{class:"header"},"無法定位",-1))),U=n((()=>(0,t.Lk)("p",null,[(0,t.eW)("如果您有不只一個住處，請填寫一個就好，其他可寫進自我介紹中。"),(0,t.Lk)("br"),(0,t.eW)("若持續無法定位，請"),(0,t.Lk)("a",{href:"https://www.google.com.tw/chrome/browser/desktop/",target:"_blank"},"使用Chrome瀏覽器"),(0,t.eW)("再試一次。")],-1))),G=[x,U],V={class:"ui warning message"},I=n((()=>(0,t.Lk)("div",{class:"header"},"地址重疊",-1))),J=n((()=>(0,t.Lk)("p",null,"有別人使用了這個地址。您可以加上村里或是路段，來使定位更精準",-1))),A=[I,J],F={class:"ui warning message"},T=n((()=>(0,t.Lk)("div",{class:"header"},"地址太詳細了",-1))),W=n((()=>(0,t.Lk)("p",null,"這是公開資料，最細寫到路段即可，請不要寫出門牌號碼。",-1))),q=[T,W],E=n((()=>(0,t.Lk)("div",{id:"map",style:{height:"300px"}},null,-1))),M=n((()=>(0,t.Lk)("div",{class:"ui divider"},null,-1))),X={class:"field"},j=n((()=>(0,t.Lk)("label",null,"網址",-1))),R={class:"two fields"},$={class:"field"},D=["href"],Q=["src"],S={class:"field"},K=["href"],N=["src"],O={class:"two fields"},Z={class:"field"},z=n((()=>(0,t.Lk)("label",{class:"required"},"有效聯絡方式",-1))),B={class:"field"},H=n((()=>(0,t.Lk)("label",null,"比較有空的時段",-1))),P=n((()=>(0,t.Lk)("h4",{class:"ui dividing header"},"社交資訊",-1))),Y={class:"field"},ee=n((()=>(0,t.Lk)("label",null,"您的身份",-1))),le=n((()=>(0,t.Lk)("option",{value:""}," -- 選擇一種自學身份 -- ",-1))),oe=["selected","value"],te={class:"field"},ae=n((()=>(0,t.Lk)("label",null,"主要的自學型態",-1))),se=n((()=>(0,t.Lk)("option",{value:""}," -- 選擇一種自學型態 -- ",-1))),ne=["selected","value"],re=n((()=>(0,t.Lk)("label",{class:"required"},"您的出生年次(西元)",-1))),ie={class:"ui warning message"},de=n((()=>(0,t.Lk)("div",{class:"header"},"請填出生年份",-1))),ue=n((()=>(0,t.Lk)("p",null,"這是為了尋友用，如果您不願意填真實年份，可以增減1~2歲。",-1))),ce=[de,ue],he={class:"ui error message"},ke=n((()=>(0,t.Lk)("div",{class:"header"},"無法計算年歲",-1))),pe=n((()=>(0,t.Lk)("p",null," 出生年(西元)的欄位僅能填寫數字喔",-1))),Le=[ke,pe],me={class:"field"},ge=n((()=>(0,t.Lk)("label",null,"孩子的出生年次(西元)，若還沒有孩子或還不需找共學夥伴可略過本項",-1))),be=n((()=>(0,t.Lk)("br",null,null,-1))),ve=n((()=>(0,t.Lk)("div",{class:"ui divider"},null,-1))),fe={style:{"margin-left":"15px"}},_e=n((()=>(0,t.Lk)("br",null,null,-1))),ye=n((()=>(0,t.Lk)("br",null,null,-1))),Ce=n((()=>(0,t.Lk)("div",{class:"ui divider"},null,-1))),we={class:"three fields"},xe={class:"field"},Ue=n((()=>(0,t.Lk)("label",{class:"required"},"個人興趣",-1))),Ge={class:"field"},Ve=n((()=>(0,t.Lk)("label",{class:"required"},"可分享",-1))),Ie={class:"field"},Je=n((()=>(0,t.Lk)("label",null,"尋找",-1))),Ae={class:"field"},Fe=n((()=>(0,t.Lk)("label",null,"可支付",-1))),Te={class:"field"},We=n((()=>(0,t.Lk)("label",{class:"required"},"自我介紹",-1))),qe={class:"ui warning message"},Ee={class:"header"},Me=n((()=>(0,t.Lk)("p",null,"愈詳細別人愈能認識您，您的旗幟才好發揮作用。 ",-1))),Xe={class:"ui success message"},je=n((()=>(0,t.Lk)("div",{class:"header"},"謝謝您",-1))),Re=n((()=>(0,t.Lk)("p",null,"您詳細的介紹，讓人能夠更認識您。",-1))),$e=[je,Re],De={class:"warning"},Qe=n((()=>(0,t.Lk)("i",{class:"red star"},null,-1))),Se=n((()=>(0,t.Lk)("div",{class:"ui divider"},null,-1))),Ke=n((()=>(0,t.Lk)("br",null,null,-1))),Ne=n((()=>(0,t.Lk)("br",null,null,-1))),Oe=n((()=>(0,t.Lk)("br",null,null,-1))),Ze=n((()=>(0,t.Lk)("br",null,null,-1))),ze=n((()=>(0,t.Lk)("br",null,null,-1)));function Be(e,l,o,n,x,U){return(0,t.uX)(),(0,t.CE)("div",r,[o.isInApp?((0,t.uX)(),(0,t.CE)("p",i,"本系統不支援facebook, link等app內部瀏覽，請用一般瀏覽器開啟，方可登入，謝謝")):(0,t.Q3)("",!0),o.uid&&!x.root.name&&o.users?((0,t.uX)(),(0,t.CE)("div",{key:1,class:"ui massive blue button",onClick:l[0]||(l[0]=e=>U.setMe())},"按此開始")):(0,t.Q3)("",!0),o.user?(0,t.Q3)("",!0):((0,t.uX)(),(0,t.CE)("div",d,[(0,t.Lk)("button",{class:"ui orange button",onClick:l[1]||(l[1]=(...e)=>U.loginGoogle&&U.loginGoogle(...e))},[u,(0,t.eW)("登入")])])),x.root.name?((0,t.uX)(),(0,t.CE)("div",c,[(0,t.bo)((0,t.Lk)("div",h,[k,U.longTimeNoSee()>.25?((0,t.uX)(),(0,t.CE)("span",p,"您的資料已三個月未更新，請立即更新，謝謝")):U.longTimeNoSee(1)?((0,t.uX)(),(0,t.CE)("span",L,"您的資料已一年未更新，目前已被系統隱藏，請立即更新即可恢復顯示。")):(0,t.Q3)("",!0)],512),[[a.aG,U.longTimeNoSee()>.25]]),(0,t.Lk)("form",m,[g,b,v,(0,t.Lk)("div",f,[_,(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":l[2]||(l[2]=e=>x.root.name=e),placeholder:"您的大名"},null,512),[[a.Jo,x.root.name]])]),(0,t.Lk)("div",{class:(0,s.C4)(["field",{error:x.root.address&&("undefined,undefined"==x.root.latlngColumn||"36.778261,-119.4179324"==x.root.latlngColumn)}])},[y,(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>x.root.address=e),onKeyup:l[4]||(l[4]=e=>U.checkLatLng(x.root.address)),placeholder:"地址愈詳細，別人愈好認識你的所在"},null,544),[[a.Jo,x.root.address,void 0,{trim:!0}]]),(0,t.bo)((0,t.Lk)("span",null,[(0,t.Lk)("span",{innerHTML:x.root.latlngColumn},null,8,C)],512),[[a.aG,x.root.address&&"undefined,undefined"!==x.root.latlngColumn&&"36.778261,-119.4179324"!==x.root.latlngColumn]]),(0,t.bo)((0,t.Lk)("div",w,G,512),[[a.aG,x.root.address&&("undefined,undefined"==x.root.latlngColumn||"36.778261,-119.4179324"==x.root.latlngColumn)]]),(0,t.bo)((0,t.Lk)("div",V,A,512),[[a.aG,U.usedAddr(x.root)]]),(0,t.bo)((0,t.Lk)("div",F,q,512),[[a.aG,U.tooDetail(x.root.address)]])],2),E,M,(0,t.Lk)("div",X,[j,(0,t.Lk)("div",R,[(0,t.Lk)("div",$,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[5]||(l[5]=e=>x.root.site=e),placeholder:"個人網址"},null,512),[[a.Jo,x.root.site]]),(0,t.bo)((0,t.Lk)("span",null,[(0,t.Lk)("a",{href:x.root.site,target:"_blank"},[(0,t.Lk)("img",{src:"https://www.google.com/s2/favicons?domain="+x.root.site,title:"個人網址",alt:"個人網址"},null,8,Q),(0,t.eW)("測試連結")],8,D)],512),[[a.aG,x.root.site]])]),(0,t.Lk)("div",S,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[6]||(l[6]=e=>x.root.site2=e),placeholder:"參與的社群網址"},null,512),[[a.Jo,x.root.site2]]),(0,t.bo)((0,t.Lk)("span",null,[(0,t.bo)((0,t.Lk)("a",{href:x.root.site2,target:"_blank"},[(0,t.Lk)("img",{src:"https://www.google.com/s2/favicons?domain="+x.root.site2,title:"社群網址",alt:"社群網址"},null,8,N),(0,t.eW)("測試連結")],8,K),[[a.aG,x.root.site2]])],512),[[a.aG,x.root.site2]])])])]),(0,t.Lk)("div",O,[(0,t.Lk)("div",Z,[z,(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":l[7]||(l[7]=e=>x.root.connect_me=e),placeholder:"可公開的方式，如e-mail。臉書私訊不可"},null,512),[[a.Jo,x.root.connect_me]])]),(0,t.Lk)("div",B,[H,(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":l[8]||(l[8]=e=>x.root.freetime=e),placeholder:"例如：週五下午和週末"},null,512),[[a.Jo,x.root.freetime]])])]),P,(0,t.Lk)("div",Y,[ee,(0,t.bo)((0,t.Lk)("select",{class:"selectpicker","onUpdate:modelValue":l[9]||(l[9]=e=>x.root.learner_role=e)},[le,((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(["自學生","自學家長","獨立教育工作者","自學家長 + 獨立教育工作者","自學生 + 獨立教育工作者","自學生 + 自學家長","自學生 + 自學家長 + 獨立教育工作者"],(e=>(0,t.Lk)("option",{selected:x.root.learner_role==e,value:e},(0,s.v_)(e),9,oe))),64))],512),[[a.u1,x.root.learner_role]])]),(0,t.Lk)("div",te,[ae,(0,t.bo)((0,t.Lk)("select",{class:"selectpicker","onUpdate:modelValue":l[10]||(l[10]=e=>x.root.learner_type=e)},[se,((0,t.uX)(),(0,t.CE)(t.FK,null,(0,t.pI)(["個人","三五好友","團體共學","類學校機構"],(e=>(0,t.Lk)("option",{selected:x.root.learner_type==e,value:e},(0,s.v_)(e),9,ne))),64))],512),[[a.u1,x.root.learner_type]])]),(0,t.Lk)("div",{class:(0,s.C4)(["field",{error:e.badAge(x.root.learner_birth),warning:!x.root.learner_birth}])},[re,(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[11]||(l[11]=e=>x.root.learner_birth=e),type:"text",placeholder:"您自己的年次，如1976"},null,512),[[a.Jo,x.root.learner_birth]])],2),(0,t.bo)((0,t.Lk)("span",null,"大約"+(0,s.v_)(e.toAge(x.root.learner_birth))+"歲",513),[[a.aG,x.root.learner_birth]]),(0,t.bo)((0,t.Lk)("div",ie,ce,512),[[a.aG,!x.root.learner_birth]]),(0,t.bo)((0,t.Lk)("div",he,Le,512),[[a.aG,e.badAge(x.root.learner_birth)]]),(0,t.Lk)("div",me,[ge,(0,t.Lk)("span",null,[(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[12]||(l[12]=e=>x.root.child_birth=e),type:"text",placeholder:"最大孩子的出生年次(西元)"},null,512),[[a.Jo,x.root.child_birth]]),be,(0,t.bo)((0,t.Lk)("span",null,"大約"+(0,s.v_)(e.toAge(x.root.child_birth))+"歲",513),[[a.aG,x.root.child_birth]]),ve,(0,t.Lk)("span",fe,[(0,t.eW)("若您有多位孩子，請再填寫："),_e,(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[13]||(l[13]=e=>x.root.child_birth2=e),type:"text",placeholder:"最小孩子的出生年次(西元)"},null,512),[[a.Jo,x.root.child_birth2]]),ye]),(0,t.bo)((0,t.Lk)("span",null,"大約"+(0,s.v_)(e.toAge(x.root.child_birth2))+"歲~"+(0,s.v_)(e.toAge(x.root.child_birth))+"歲 ",513),[[a.aG,x.root.child_birth2]])]),Ce,(0,t.Lk)("div",we,[(0,t.Lk)("div",xe,[Ue,(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[14]||(l[14]=e=>x.root.learner_habit=e),placeholder:"個人興趣"},null,512),[[a.Jo,x.root.learner_habit]])]),(0,t.Lk)("div",Ge,[Ve,(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[15]||(l[15]=e=>x.root.share=e),placeholder:"知識、服務、場地設備或物資"},null,512),[[a.Jo,x.root.share]])]),(0,t.Lk)("div",Ie,[Je,(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[16]||(l[16]=e=>x.root.ask=e),placeholder:"讓人知道可以協助你什麼?"},null,512),[[a.Jo,x.root.ask]])]),(0,t.Lk)("div",Ae,[Fe,(0,t.bo)((0,t.Lk)("input",{"onUpdate:modelValue":l[17]||(l[17]=e=>x.root.price=e),placeholder:"你願意支付多少錢或換工來得到協助?"},null,512),[[a.Jo,x.root.price]])])]),(0,t.Lk)("div",Te,[We,(0,t.bo)((0,t.Lk)("textarea",{id:"note","onUpdate:modelValue":l[18]||(l[18]=e=>x.root.note=e),rows:"5",cols:"30",placeholder:"自我介紹很重要，請寫20字以上，謝謝"},null,512),[[a.Jo,x.root.note]])]),(0,t.bo)((0,t.Lk)("div",qe,[(0,t.Lk)("div",Ee,"請再寫"+(0,s.v_)(20-x.root.note.length)+"字介紹您自己",1),Me],512),[[a.aG,x.root.note&&x.root.note.length<20]]),(0,t.bo)((0,t.Lk)("div",Xe,$e,512),[[a.aG,x.root.note&&x.root.note.length>=20]])]),(0,t.bo)((0,t.Lk)("div",De,[(0,t.eW)("note: 您還有"),Qe,(0,t.eW)("必填項目尚未填寫")],512),[[a.aG,!e.isValid(x.root)]])]),Se,(0,t.Lk)("a",{class:(0,s.C4)(["ui large blue button",{disabled:!e.isValid(x.root)}]),onClick:l[19]||(l[19]=(...e)=>U.updateFlag&&U.updateFlag(...e))},[(0,t.bo)((0,t.Lk)("span",null,"升起旗幟!!",512),[[a.aG,!o.users[o.uid]]]),(0,t.bo)((0,t.Lk)("span",null,"更新旗幟!!",512),[[a.aG,o.users[o.uid]]])],2),Ke,Ne,Oe,Ze,ze])):(0,t.Q3)("",!0)])}var He=o(9034),Pe=o(6808),Ye=o(4161),el=o(6886),ll=o(8355),ol={name:"MyFlag",mixins:[He.A],props:["uid","user","email","mySearch","provider","photoURL","users","isInApp"],metaInfo:{title:"我的旗幟"},data(){return{myIndex:-1,root:{latlngColumn:"23.5330, 121.0654"},local:{},map:null,marker:null}},emit:["loginGoogle","locate"],mounted(){this.$nextTick((()=>{this.root.name&&(el.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/",setTimeout(this.initMap,500))}))},watch:{root(e){e.name&&setTimeout(this.initMap,500)}},methods:{initMap(){this.map=el.map("map").setView(this.root.latlngColumn.split(","),7),el.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:18,attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'}).addTo(this.map),el.Icon.Default.imagePath="//cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/",this.marker=el.marker(this.map.getCenter(),{draggable:!1}).addTo(this.map),this.map.on("moveend",(()=>{const{lat:e,lng:l}=this.map.getCenter();this.marker.setLatLng({lat:e,lng:l}),this.root.latlngColumn=`${e.toFixed(5)},${l.toFixed(5)}`,this.$forceUpdate()}))},setMe(){console.log(this.users);const e=Object.keys(this.users);this.root=this.users[this.uid]||{},this.root.email=this.email,console.log(this.root.email),this.myIndex=e.indexOf(this.uid),this.uid&&-1===this.myIndex&&(console.log("new"),this.myIndex=this.uid,this.root={name:this.user.providerData[0].displayName||"新朋友",uid:this.uid,email:this.email,photoURL:this.photoURL||"",note:""}),console.log(this.root.name),console.log(this.root),this.$forceUpdate()},longTimeNoSee(){const e=(new Date).getTime();return(e-this.root.lastUpdate)/1e3/3600/24/365.25},checkLatLng:function(e){console.log("checkLatLng:"+e);var l=this;ll.A.get("https://api.opencagedata.com/geocode/v1/json?q="+encodeURIComponent(e)+"&key=ee2340e9a9e146e090943337d14a76d4&language=zh&pretty=1").then((e=>{var o,t,a=e.body;console.log(a);try{o=a.results[0].bounds.northeast.lat,t=a.results[0].bounds.northeast.lng}catch(s){console.log(s)}if(!o||!t)try{o=a.query.results.Result.latitude,t=a.query.results.Result.longitude}catch(s){console.log(s)}l.root.latlngColumn=o+","+t,l.local.lat=parseFloat(o),l.local.lng=parseFloat(t)})).catch((e=>{console.error("Error:",e)}))},usedAddr:function(e){console.log(this.users);var l=this;const o=Object.keys(this.users),t=o.map((function(e){return l.users[e]}));var a,s,n,r,i;for(a=!1,s=0,r=(n=t.filter(d)).length;s<r;++s)if(i=n[s],i.latlngColumn===e.latlngColumn){a=!0;break}return"undefined,undefined"!==e.latlngColumn&&"36.778261,-119.4179324"!==e.latlngColumn||(a=!1),a;function d(l){return l.name!==e.name}},tooDetail:function(e){return!!e&&!!e.match(/(號|樓|F|f)/)},updateFlag:function(){this.root.lastUpdate=(new Date).getTime(),this.myIndex>-1?(0,Ye.hZ)((0,Ye.KR)(Pe.db,"users/"+this.uid),this.root).then(alert("更新成功!")):(console.log("new2"),(0,Ye.hZ)((0,Ye.KR)(Pe.db,"users/"+this.uid),this.root).then(alert("登錄成功!"))),this.$emit("locate",this.root,!1)},loginFB:function(){this.$emit("loginFB")},loginGoogle:function(){this.$emit("loginGoogle")}}},tl=o(1241);const al=(0,tl.A)(ol,[["render",Be],["__scopeId","data-v-2f2fcabc"]]);var sl=al}}]);
//# sourceMappingURL=profile.d71a04e0.js.map